import importlib

import numpy as np
import pandas as pd
import pytest
from pandas.testing import assert_frame_equal, assert_series_equal

from bofire.data_models.enum import MolecularEncodingEnum
from bofire.data_models.features.molecular import MolecularInput
from bofire.data_models.molfeatures.api import (
    Fingerprints,
    FingerprintsFragments,
    Fragments,
    MordredDescriptors,
)
from bofire.utils.cheminformatics import (  # smiles2bag_of_characters,
    smiles2fingerprints,
    smiles2fragments,
    smiles2mordred,
)

RDKIT_AVAILABLE = importlib.util.find_spec("rdkit") is not None

smiles = [
    "CC(=O)Oc1ccccc1C(=O)O",
    "c1ccccc1",
    "[CH3][CH2][OH]",
    "N[C@](C)(F)C(=O)O",
]
VALID_SMILES = pd.Series(smiles)
VALID_SMILES.name = "molecule"
INVALID_SMILES = pd.Series(["CC(=O)Oc1ccccc1C(=O)O", "c1ccccc1", "abcd"])


@pytest.mark.skipif(not RDKIT_AVAILABLE, reason="requires rdkit")
def test_molecular_input_validate_experimental():
    m = MolecularInput(
        key="molecules", smiles=smiles, molfeatures=Fingerprints(n_bits=32)
    )
    vals = m.validate_experimental(VALID_SMILES)
    assert_series_equal(vals, VALID_SMILES)
    with pytest.raises(ValueError):
        m.validate_experimental(INVALID_SMILES)


@pytest.mark.skipif(not RDKIT_AVAILABLE, reason="requires rdkit")
def test_molecular_input_validate_experimental_invalid_experiments():
    experiments = pd.Series(
        [
            "CC(=O)Oc1ccccc1C(=O)O",
            "c1ccccc1",
            "[CH3][CH2][OH]",
            "C=CC1CCC(C=C)C(C1)C=C",
            "N[C@](C)(F)C(=O)O",
        ]
    )
    m = MolecularInput(
        key="molecules", smiles=smiles, molfeatures=Fingerprints(n_bits=32)
    )
    with pytest.raises(ValueError):
        m.validate_experimental(experiments)


@pytest.mark.skipif(not RDKIT_AVAILABLE, reason="requires rdkit")
def test_molecular_input_validate_candidental():
    m = MolecularInput(
        key="molecules", smiles=smiles, molfeatures=Fingerprints(n_bits=32)
    )
    vals = m.validate_candidental(VALID_SMILES)
    assert_series_equal(vals, VALID_SMILES)
    with pytest.raises(ValueError):
        m.validate_candidental(INVALID_SMILES)


@pytest.mark.skipif(not RDKIT_AVAILABLE, reason="requires rdkit")
def test_molecular_input_fixed():
    m = MolecularInput(
        key="molecules", smiles=smiles, molfeatures=Fingerprints(n_bits=32)
    )
    assert m.fixed_value() is None
    assert m.is_fixed() is False


@pytest.mark.skipif(not RDKIT_AVAILABLE, reason="requires rdkit")
@pytest.mark.parametrize(
    "molfeatures, expected, transform_type",
    [
        (
            Fingerprints(n_bits=32),
            (
                [
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                ],
                [
                    1.0,
                    1.0,
                    1.0,
                    1.0,
                    1.0,
                    1.0,
                    1.0,
                    1.0,
                    1.0,
                    1.0,
                    1.0,
                    1.0,
                    0.0,
                    1.0,
                    0.0,
                    1.0,
                    1.0,
                    1.0,
                    1.0,
                    1.0,
                    0.0,
                    0.0,
                    1.0,
                    1.0,
                    0.0,
                    1.0,
                    0.0,
                    1.0,
                    1.0,
                    1.0,
                    1.0,
                    0.0,
                ],
            ),
            MolecularEncodingEnum.FINGERPRINTS,
        ),
        (
            Fragments(),
            (
                [
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                ],
                [
                    1.0,
                    1.0,
                    0.0,
                    1.0,
                    0.0,
                    0.0,
                    0.0,
                    1.0,
                    1.0,
                    2.0,
                    1.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    1.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    1.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    1.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    1.0,
                    1.0,
                    0.0,
                    0.0,
                    1.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    1.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                ],
            ),
            MolecularEncodingEnum.FRAGMENTS,
        ),
        (
            FingerprintsFragments(n_bits=32),
            (
                [
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                ],
                [
                    1.0,
                    1.0,
                    1.0,
                    1.0,
                    1.0,
                    1.0,
                    1.0,
                    1.0,
                    1.0,
                    1.0,
                    1.0,
                    1.0,
                    0.0,
                    1.0,
                    0.0,
                    1.0,
                    1.0,
                    1.0,
                    1.0,
                    1.0,
                    0.0,
                    0.0,
                    1.0,
                    1.0,
                    0.0,
                    1.0,
                    0.0,
                    1.0,
                    1.0,
                    1.0,
                    1.0,
                    0.0,
                    1.0,
                    1.0,
                    0.0,
                    1.0,
                    0.0,
                    0.0,
                    0.0,
                    1.0,
                    1.0,
                    2.0,
                    1.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    1.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    1.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    1.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    1.0,
                    1.0,
                    0.0,
                    0.0,
                    1.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    1.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                    0.0,
                ],
            ),
            MolecularEncodingEnum.FINGERPRINTS_FRAGMENTS,
        ),
        (
            MordredDescriptors(descriptors=["NssCH2", "ATSC2d"]),
            ([-8.34319526627219, 0.0], [0.5963718820861676, 1.0]),
            MolecularEncodingEnum.MOL_DESCRIPTOR,
        ),
    ],
)
def test_molecular_descriptor_feature_get_bounds(molfeatures, expected, transform_type):
    input_feature = MolecularInput(
        key="molecule", smiles=smiles, molfeatures=molfeatures
    )
    lower, upper = input_feature.get_bounds(
        transform_type=transform_type,
        values=VALID_SMILES,
    )
    assert np.allclose(lower, expected[0])
    assert np.allclose(upper, expected[1])


@pytest.mark.skipif(not RDKIT_AVAILABLE, reason="requires rdkit")
@pytest.mark.parametrize(
    "molfeatures, values",
    [
        (
            Fingerprints(n_bits=32),
            {
                "fingerprint_0": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 1.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fingerprint_1": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 1.0,
                    "N[C@](C)(F)C(=O)O": 1.0,
                },
                "fingerprint_2": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 1.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fingerprint_3": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 1.0,
                },
                "fingerprint_4": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fingerprint_5": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 1.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 1.0,
                },
                "fingerprint_6": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 1.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fingerprint_7": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 1.0,
                    "N[C@](C)(F)C(=O)O": 1.0,
                },
                "fingerprint_8": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 1.0,
                },
                "fingerprint_9": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fingerprint_10": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 1.0,
                },
                "fingerprint_11": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fingerprint_12": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fingerprint_13": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 1.0,
                },
                "fingerprint_14": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fingerprint_15": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fingerprint_16": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 1.0,
                    "[CH3][CH2][OH]": 1.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fingerprint_17": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 1.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fingerprint_18": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 1.0,
                },
                "fingerprint_19": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 1.0,
                },
                "fingerprint_20": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fingerprint_21": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fingerprint_22": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fingerprint_23": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 1.0,
                },
                "fingerprint_24": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fingerprint_25": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 1.0,
                },
                "fingerprint_26": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fingerprint_27": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fingerprint_28": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fingerprint_29": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 1.0,
                },
                "fingerprint_30": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 1.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fingerprint_31": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
            },
        ),
        (
            Fragments(),
            {
                "fr_Al_OH": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 1.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_Al_OH_noTert": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 1.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_ArN": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_Ar_COO": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_Ar_N": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_Ar_NH": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_Ar_OH": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_COO": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 1.0,
                },
                "fr_COO2": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 1.0,
                },
                "fr_C_O": {
                    "CC(=O)Oc1ccccc1C(=O)O": 2.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 1.0,
                },
                "fr_C_O_noCOO": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_C_S": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_HOCCN": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_Imine": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_NH0": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_NH1": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_NH2": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 1.0,
                },
                "fr_N_O": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_Ndealkylation1": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_Ndealkylation2": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_Nhpyrrole": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_SH": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_aldehyde": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_alkyl_carbamate": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_alkyl_halide": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 1.0,
                },
                "fr_allylic_oxid": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_amide": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_amidine": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_aniline": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_aryl_methyl": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_azide": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_azo": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_barbitur": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_benzene": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 1.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_benzodiazepine": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_bicyclic": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_diazo": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_dihydropyridine": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_epoxide": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_ester": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_ether": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_furan": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_guanido": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_halogen": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 1.0,
                },
                "fr_hdrzine": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_hdrzone": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_imidazole": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_imide": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_isocyan": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_isothiocyan": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_ketone": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_ketone_Topliss": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_lactam": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_lactone": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_methoxy": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_morpholine": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_nitrile": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_nitro": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_nitro_arom": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_nitro_arom_nonortho": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_nitroso": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_oxazole": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_oxime": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_para_hydroxylation": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_phenol": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_phenol_noOrthoHbond": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_phos_acid": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_phos_ester": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_piperdine": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_piperzine": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_priamide": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_prisulfonamd": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_pyridine": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_quatN": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_sulfide": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_sulfonamd": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_sulfone": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_term_acetylene": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_tetrazole": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_thiazole": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_thiocyan": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_thiophene": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_unbrch_alkane": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_urea": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
            },
        ),
        (
            FingerprintsFragments(n_bits=32),
            {
                "fingerprint_0": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 1.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fingerprint_1": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 1.0,
                    "N[C@](C)(F)C(=O)O": 1.0,
                },
                "fingerprint_2": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 1.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fingerprint_3": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 1.0,
                },
                "fingerprint_4": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fingerprint_5": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 1.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 1.0,
                },
                "fingerprint_6": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 1.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fingerprint_7": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 1.0,
                    "N[C@](C)(F)C(=O)O": 1.0,
                },
                "fingerprint_8": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 1.0,
                },
                "fingerprint_9": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fingerprint_10": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 1.0,
                },
                "fingerprint_11": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fingerprint_12": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fingerprint_13": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 1.0,
                },
                "fingerprint_14": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fingerprint_15": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fingerprint_16": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 1.0,
                    "[CH3][CH2][OH]": 1.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fingerprint_17": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 1.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fingerprint_18": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 1.0,
                },
                "fingerprint_19": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 1.0,
                },
                "fingerprint_20": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fingerprint_21": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fingerprint_22": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fingerprint_23": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 1.0,
                },
                "fingerprint_24": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fingerprint_25": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 1.0,
                },
                "fingerprint_26": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fingerprint_27": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fingerprint_28": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fingerprint_29": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 1.0,
                },
                "fingerprint_30": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 1.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fingerprint_31": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_Al_OH": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 1.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_Al_OH_noTert": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 1.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_ArN": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_Ar_COO": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_Ar_N": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_Ar_NH": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_Ar_OH": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_COO": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 1.0,
                },
                "fr_COO2": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 1.0,
                },
                "fr_C_O": {
                    "CC(=O)Oc1ccccc1C(=O)O": 2.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 1.0,
                },
                "fr_C_O_noCOO": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_C_S": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_HOCCN": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_Imine": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_NH0": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_NH1": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_NH2": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 1.0,
                },
                "fr_N_O": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_Ndealkylation1": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_Ndealkylation2": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_Nhpyrrole": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_SH": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_aldehyde": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_alkyl_carbamate": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_alkyl_halide": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 1.0,
                },
                "fr_allylic_oxid": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_amide": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_amidine": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_aniline": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_aryl_methyl": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_azide": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_azo": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_barbitur": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_benzene": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 1.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_benzodiazepine": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_bicyclic": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_diazo": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_dihydropyridine": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_epoxide": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_ester": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_ether": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_furan": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_guanido": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_halogen": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 1.0,
                },
                "fr_hdrzine": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_hdrzone": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_imidazole": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_imide": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_isocyan": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_isothiocyan": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_ketone": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_ketone_Topliss": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_lactam": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_lactone": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_methoxy": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_morpholine": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_nitrile": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_nitro": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_nitro_arom": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_nitro_arom_nonortho": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_nitroso": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_oxazole": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_oxime": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_para_hydroxylation": {
                    "CC(=O)Oc1ccccc1C(=O)O": 1.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_phenol": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_phenol_noOrthoHbond": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_phos_acid": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_phos_ester": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_piperdine": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_piperzine": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_priamide": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_prisulfonamd": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_pyridine": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_quatN": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_sulfide": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_sulfonamd": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_sulfone": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_term_acetylene": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_tetrazole": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_thiazole": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_thiocyan": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_thiophene": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_unbrch_alkane": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
                "fr_urea": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 0.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
            },
        ),
        (
            MordredDescriptors(descriptors=["NssCH2", "ATSC2d"]),
            {
                "NssCH2": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.5963718820861676,
                    "c1ccccc1": -1.5,
                    "[CH3][CH2][OH]": -0.28395061728395066,
                    "N[C@](C)(F)C(=O)O": -8.34319526627219,
                },
                "ATSC2d": {
                    "CC(=O)Oc1ccccc1C(=O)O": 0.0,
                    "c1ccccc1": 0.0,
                    "[CH3][CH2][OH]": 1.0,
                    "N[C@](C)(F)C(=O)O": 0.0,
                },
            },
        ),
    ],
)
def test_molecular_input_to_df(molfeatures, values):
    input_feature = MolecularInput(
        key="molecule", smiles=smiles, molfeatures=molfeatures
    )
    df = input_feature.to_df()
    assert len(df.columns) == len(input_feature.molfeatures.descriptors)
    assert len(df) == len(smiles)
    # assert df.values.tolist() == values
    assert_frame_equal(df, pd.DataFrame.from_dict(values))


@pytest.mark.skipif(not RDKIT_AVAILABLE, reason="requires rdkit")
@pytest.mark.parametrize(
    "molfeatures, values",
    [
        (
            Fingerprints(n_bits=32),
            {
                "molecule_fingerprint_0": {0: 1.0, 1: 1.0, 2: 0.0, 3: 0.0},
                "molecule_fingerprint_1": {0: 1.0, 1: 0.0, 2: 1.0, 3: 1.0},
                "molecule_fingerprint_2": {0: 1.0, 1: 0.0, 2: 1.0, 3: 0.0},
                "molecule_fingerprint_3": {0: 1.0, 1: 0.0, 2: 0.0, 3: 1.0},
                "molecule_fingerprint_4": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fingerprint_5": {0: 1.0, 1: 1.0, 2: 0.0, 3: 1.0},
                "molecule_fingerprint_6": {0: 0.0, 1: 0.0, 2: 1.0, 3: 0.0},
                "molecule_fingerprint_7": {0: 1.0, 1: 0.0, 2: 1.0, 3: 1.0},
                "molecule_fingerprint_8": {0: 1.0, 1: 0.0, 2: 0.0, 3: 1.0},
                "molecule_fingerprint_9": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fingerprint_10": {0: 1.0, 1: 0.0, 2: 0.0, 3: 1.0},
                "molecule_fingerprint_11": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fingerprint_12": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fingerprint_13": {0: 1.0, 1: 0.0, 2: 0.0, 3: 1.0},
                "molecule_fingerprint_14": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fingerprint_15": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fingerprint_16": {0: 1.0, 1: 1.0, 2: 1.0, 3: 0.0},
                "molecule_fingerprint_17": {0: 1.0, 1: 1.0, 2: 0.0, 3: 0.0},
                "molecule_fingerprint_18": {0: 1.0, 1: 0.0, 2: 0.0, 3: 1.0},
                "molecule_fingerprint_19": {0: 0.0, 1: 0.0, 2: 0.0, 3: 1.0},
                "molecule_fingerprint_20": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fingerprint_21": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fingerprint_22": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fingerprint_23": {0: 1.0, 1: 0.0, 2: 0.0, 3: 1.0},
                "molecule_fingerprint_24": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fingerprint_25": {0: 1.0, 1: 0.0, 2: 0.0, 3: 1.0},
                "molecule_fingerprint_26": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fingerprint_27": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fingerprint_28": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fingerprint_29": {0: 1.0, 1: 0.0, 2: 0.0, 3: 1.0},
                "molecule_fingerprint_30": {0: 0.0, 1: 0.0, 2: 1.0, 3: 0.0},
                "molecule_fingerprint_31": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
            },
        ),
        (
            Fragments(),
            {
                "molecule_fr_Al_OH": {0: 0.0, 1: 0.0, 2: 1.0, 3: 0.0},
                "molecule_fr_Al_OH_noTert": {0: 0.0, 1: 0.0, 2: 1.0, 3: 0.0},
                "molecule_fr_ArN": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_Ar_COO": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_Ar_N": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_Ar_NH": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_Ar_OH": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_COO": {0: 1.0, 1: 0.0, 2: 0.0, 3: 1.0},
                "molecule_fr_COO2": {0: 1.0, 1: 0.0, 2: 0.0, 3: 1.0},
                "molecule_fr_C_O": {0: 2.0, 1: 0.0, 2: 0.0, 3: 1.0},
                "molecule_fr_C_O_noCOO": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_C_S": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_HOCCN": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_Imine": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_NH0": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_NH1": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_NH2": {0: 0.0, 1: 0.0, 2: 0.0, 3: 1.0},
                "molecule_fr_N_O": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_Ndealkylation1": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_Ndealkylation2": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_Nhpyrrole": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_SH": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_aldehyde": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_alkyl_carbamate": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_alkyl_halide": {0: 0.0, 1: 0.0, 2: 0.0, 3: 1.0},
                "molecule_fr_allylic_oxid": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_amide": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_amidine": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_aniline": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_aryl_methyl": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_azide": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_azo": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_barbitur": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_benzene": {0: 1.0, 1: 1.0, 2: 0.0, 3: 0.0},
                "molecule_fr_benzodiazepine": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_bicyclic": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_diazo": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_dihydropyridine": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_epoxide": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_ester": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_ether": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_furan": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_guanido": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_halogen": {0: 0.0, 1: 0.0, 2: 0.0, 3: 1.0},
                "molecule_fr_hdrzine": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_hdrzone": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_imidazole": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_imide": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_isocyan": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_isothiocyan": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_ketone": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_ketone_Topliss": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_lactam": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_lactone": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_methoxy": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_morpholine": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_nitrile": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_nitro": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_nitro_arom": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_nitro_arom_nonortho": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_nitroso": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_oxazole": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_oxime": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_para_hydroxylation": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_phenol": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_phenol_noOrthoHbond": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_phos_acid": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_phos_ester": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_piperdine": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_piperzine": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_priamide": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_prisulfonamd": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_pyridine": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_quatN": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_sulfide": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_sulfonamd": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_sulfone": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_term_acetylene": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_tetrazole": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_thiazole": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_thiocyan": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_thiophene": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_unbrch_alkane": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_urea": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
            },
        ),
        (
            FingerprintsFragments(n_bits=32),
            {
                "molecule_fingerprint_0": {0: 1.0, 1: 1.0, 2: 0.0, 3: 0.0},
                "molecule_fingerprint_1": {0: 1.0, 1: 0.0, 2: 1.0, 3: 1.0},
                "molecule_fingerprint_2": {0: 1.0, 1: 0.0, 2: 1.0, 3: 0.0},
                "molecule_fingerprint_3": {0: 1.0, 1: 0.0, 2: 0.0, 3: 1.0},
                "molecule_fingerprint_4": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fingerprint_5": {0: 1.0, 1: 1.0, 2: 0.0, 3: 1.0},
                "molecule_fingerprint_6": {0: 0.0, 1: 0.0, 2: 1.0, 3: 0.0},
                "molecule_fingerprint_7": {0: 1.0, 1: 0.0, 2: 1.0, 3: 1.0},
                "molecule_fingerprint_8": {0: 1.0, 1: 0.0, 2: 0.0, 3: 1.0},
                "molecule_fingerprint_9": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fingerprint_10": {0: 1.0, 1: 0.0, 2: 0.0, 3: 1.0},
                "molecule_fingerprint_11": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fingerprint_12": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fingerprint_13": {0: 1.0, 1: 0.0, 2: 0.0, 3: 1.0},
                "molecule_fingerprint_14": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fingerprint_15": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fingerprint_16": {0: 1.0, 1: 1.0, 2: 1.0, 3: 0.0},
                "molecule_fingerprint_17": {0: 1.0, 1: 1.0, 2: 0.0, 3: 0.0},
                "molecule_fingerprint_18": {0: 1.0, 1: 0.0, 2: 0.0, 3: 1.0},
                "molecule_fingerprint_19": {0: 0.0, 1: 0.0, 2: 0.0, 3: 1.0},
                "molecule_fingerprint_20": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fingerprint_21": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fingerprint_22": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fingerprint_23": {0: 1.0, 1: 0.0, 2: 0.0, 3: 1.0},
                "molecule_fingerprint_24": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fingerprint_25": {0: 1.0, 1: 0.0, 2: 0.0, 3: 1.0},
                "molecule_fingerprint_26": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fingerprint_27": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fingerprint_28": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fingerprint_29": {0: 1.0, 1: 0.0, 2: 0.0, 3: 1.0},
                "molecule_fingerprint_30": {0: 0.0, 1: 0.0, 2: 1.0, 3: 0.0},
                "molecule_fingerprint_31": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_Al_OH": {0: 0.0, 1: 0.0, 2: 1.0, 3: 0.0},
                "molecule_fr_Al_OH_noTert": {0: 0.0, 1: 0.0, 2: 1.0, 3: 0.0},
                "molecule_fr_ArN": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_Ar_COO": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_Ar_N": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_Ar_NH": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_Ar_OH": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_COO": {0: 1.0, 1: 0.0, 2: 0.0, 3: 1.0},
                "molecule_fr_COO2": {0: 1.0, 1: 0.0, 2: 0.0, 3: 1.0},
                "molecule_fr_C_O": {0: 2.0, 1: 0.0, 2: 0.0, 3: 1.0},
                "molecule_fr_C_O_noCOO": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_C_S": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_HOCCN": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_Imine": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_NH0": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_NH1": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_NH2": {0: 0.0, 1: 0.0, 2: 0.0, 3: 1.0},
                "molecule_fr_N_O": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_Ndealkylation1": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_Ndealkylation2": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_Nhpyrrole": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_SH": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_aldehyde": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_alkyl_carbamate": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_alkyl_halide": {0: 0.0, 1: 0.0, 2: 0.0, 3: 1.0},
                "molecule_fr_allylic_oxid": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_amide": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_amidine": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_aniline": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_aryl_methyl": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_azide": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_azo": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_barbitur": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_benzene": {0: 1.0, 1: 1.0, 2: 0.0, 3: 0.0},
                "molecule_fr_benzodiazepine": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_bicyclic": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_diazo": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_dihydropyridine": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_epoxide": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_ester": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_ether": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_furan": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_guanido": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_halogen": {0: 0.0, 1: 0.0, 2: 0.0, 3: 1.0},
                "molecule_fr_hdrzine": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_hdrzone": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_imidazole": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_imide": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_isocyan": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_isothiocyan": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_ketone": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_ketone_Topliss": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_lactam": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_lactone": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_methoxy": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_morpholine": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_nitrile": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_nitro": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_nitro_arom": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_nitro_arom_nonortho": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_nitroso": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_oxazole": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_oxime": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_para_hydroxylation": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_phenol": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_phenol_noOrthoHbond": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_phos_acid": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_phos_ester": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_piperdine": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_piperzine": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_priamide": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_prisulfonamd": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_pyridine": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_quatN": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_sulfide": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_sulfonamd": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_sulfone": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_term_acetylene": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_tetrazole": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_thiazole": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_thiocyan": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_thiophene": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_unbrch_alkane": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
                "molecule_fr_urea": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
            },
        ),
        (
            MordredDescriptors(descriptors=["NssCH2", "ATSC2d"]),
            {
                "molecule_NssCH2": {
                    0: 0.5963718820861676,
                    1: -1.5,
                    2: -0.28395061728395066,
                    3: -8.34319526627219,
                },
                "molecule_ATSC2d": {0: 0.0, 1: 0.0, 2: 1.0, 3: 0.0},
            },
        ),
    ],
)
def test_molecular_input_to_from_descriptor_encoding(molfeatures, values):
    input_feature = MolecularInput(
        key="molecule", smiles=smiles, molfeatures=molfeatures
    )

    encoded = input_feature.to_descriptor_encoding(VALID_SMILES)
    assert len(encoded.columns) == len(input_feature.molfeatures.descriptors)
    assert len(encoded) == len(smiles)
    assert_frame_equal(encoded, pd.DataFrame.from_dict(values))

    unencoded = input_feature.from_descriptor_encoding(encoded)
    assert np.all(VALID_SMILES == unencoded)


@pytest.mark.skipif(not RDKIT_AVAILABLE, reason="requires rdkit")
def test_molfeatures_type_fingerprints():
    values = {
        "fingerprint_0": {0: 1.0, 1: 1.0, 2: 0.0, 3: 0.0},
        "fingerprint_1": {0: 1.0, 1: 0.0, 2: 1.0, 3: 1.0},
        "fingerprint_2": {0: 1.0, 1: 0.0, 2: 1.0, 3: 0.0},
        "fingerprint_3": {0: 1.0, 1: 0.0, 2: 0.0, 3: 1.0},
        "fingerprint_4": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fingerprint_5": {0: 1.0, 1: 1.0, 2: 0.0, 3: 1.0},
        "fingerprint_6": {0: 0.0, 1: 0.0, 2: 1.0, 3: 0.0},
        "fingerprint_7": {0: 1.0, 1: 0.0, 2: 1.0, 3: 1.0},
        "fingerprint_8": {0: 1.0, 1: 0.0, 2: 0.0, 3: 1.0},
        "fingerprint_9": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fingerprint_10": {0: 1.0, 1: 0.0, 2: 0.0, 3: 1.0},
        "fingerprint_11": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fingerprint_12": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fingerprint_13": {0: 1.0, 1: 0.0, 2: 0.0, 3: 1.0},
        "fingerprint_14": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fingerprint_15": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fingerprint_16": {0: 1.0, 1: 1.0, 2: 1.0, 3: 0.0},
        "fingerprint_17": {0: 1.0, 1: 1.0, 2: 0.0, 3: 0.0},
        "fingerprint_18": {0: 1.0, 1: 0.0, 2: 0.0, 3: 1.0},
        "fingerprint_19": {0: 0.0, 1: 0.0, 2: 0.0, 3: 1.0},
        "fingerprint_20": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fingerprint_21": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fingerprint_22": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fingerprint_23": {0: 1.0, 1: 0.0, 2: 0.0, 3: 1.0},
        "fingerprint_24": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fingerprint_25": {0: 1.0, 1: 0.0, 2: 0.0, 3: 1.0},
        "fingerprint_26": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fingerprint_27": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fingerprint_28": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fingerprint_29": {0: 1.0, 1: 0.0, 2: 0.0, 3: 1.0},
        "fingerprint_30": {0: 0.0, 1: 0.0, 2: 1.0, 3: 0.0},
        "fingerprint_31": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
    }

    input_feature = MolecularInput(
        key="molecule", smiles=smiles, molfeatures=Fingerprints(n_bits=32)
    )
    generated = input_feature.molfeatures(VALID_SMILES)
    assert_frame_equal(generated, pd.DataFrame.from_dict(values))


@pytest.mark.skipif(not RDKIT_AVAILABLE, reason="requires rdkit")
def test_molfeatures_type_fragments():
    values = {
        "fr_Al_OH": {0: 0.0, 1: 0.0, 2: 1.0, 3: 0.0},
        "fr_Al_OH_noTert": {0: 0.0, 1: 0.0, 2: 1.0, 3: 0.0},
        "fr_ArN": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_Ar_COO": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_Ar_N": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_Ar_NH": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_Ar_OH": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_COO": {0: 1.0, 1: 0.0, 2: 0.0, 3: 1.0},
        "fr_COO2": {0: 1.0, 1: 0.0, 2: 0.0, 3: 1.0},
        "fr_C_O": {0: 2.0, 1: 0.0, 2: 0.0, 3: 1.0},
        "fr_C_O_noCOO": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_C_S": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_HOCCN": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_Imine": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_NH0": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_NH1": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_NH2": {0: 0.0, 1: 0.0, 2: 0.0, 3: 1.0},
        "fr_N_O": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_Ndealkylation1": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_Ndealkylation2": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_Nhpyrrole": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_SH": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_aldehyde": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_alkyl_carbamate": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_alkyl_halide": {0: 0.0, 1: 0.0, 2: 0.0, 3: 1.0},
        "fr_allylic_oxid": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_amide": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_amidine": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_aniline": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_aryl_methyl": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_azide": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_azo": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_barbitur": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_benzene": {0: 1.0, 1: 1.0, 2: 0.0, 3: 0.0},
        "fr_benzodiazepine": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_bicyclic": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_diazo": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_dihydropyridine": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_epoxide": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_ester": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_ether": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_furan": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_guanido": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_halogen": {0: 0.0, 1: 0.0, 2: 0.0, 3: 1.0},
        "fr_hdrzine": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_hdrzone": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_imidazole": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_imide": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_isocyan": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_isothiocyan": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_ketone": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_ketone_Topliss": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_lactam": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_lactone": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_methoxy": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_morpholine": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_nitrile": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_nitro": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_nitro_arom": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_nitro_arom_nonortho": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_nitroso": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_oxazole": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_oxime": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_para_hydroxylation": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_phenol": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_phenol_noOrthoHbond": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_phos_acid": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_phos_ester": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_piperdine": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_piperzine": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_priamide": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_prisulfonamd": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_pyridine": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_quatN": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_sulfide": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_sulfonamd": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_sulfone": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_term_acetylene": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_tetrazole": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_thiazole": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_thiocyan": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_thiophene": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_unbrch_alkane": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_urea": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
    }

    input_feature = MolecularInput(
        key="molecule", smiles=smiles, molfeatures=Fragments()
    )
    generated = input_feature.molfeatures(VALID_SMILES)
    assert_frame_equal(generated, pd.DataFrame.from_dict(values))


@pytest.mark.skipif(not RDKIT_AVAILABLE, reason="requires rdkit")
def test_molfeatures_type_fingerprintsfragments():
    values = {
        "fingerprint_0": {0: 1.0, 1: 1.0, 2: 0.0, 3: 0.0},
        "fingerprint_1": {0: 1.0, 1: 0.0, 2: 1.0, 3: 1.0},
        "fingerprint_2": {0: 1.0, 1: 0.0, 2: 1.0, 3: 0.0},
        "fingerprint_3": {0: 1.0, 1: 0.0, 2: 0.0, 3: 1.0},
        "fingerprint_4": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fingerprint_5": {0: 1.0, 1: 1.0, 2: 0.0, 3: 1.0},
        "fingerprint_6": {0: 0.0, 1: 0.0, 2: 1.0, 3: 0.0},
        "fingerprint_7": {0: 1.0, 1: 0.0, 2: 1.0, 3: 1.0},
        "fingerprint_8": {0: 1.0, 1: 0.0, 2: 0.0, 3: 1.0},
        "fingerprint_9": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fingerprint_10": {0: 1.0, 1: 0.0, 2: 0.0, 3: 1.0},
        "fingerprint_11": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fingerprint_12": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fingerprint_13": {0: 1.0, 1: 0.0, 2: 0.0, 3: 1.0},
        "fingerprint_14": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fingerprint_15": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fingerprint_16": {0: 1.0, 1: 1.0, 2: 1.0, 3: 0.0},
        "fingerprint_17": {0: 1.0, 1: 1.0, 2: 0.0, 3: 0.0},
        "fingerprint_18": {0: 1.0, 1: 0.0, 2: 0.0, 3: 1.0},
        "fingerprint_19": {0: 0.0, 1: 0.0, 2: 0.0, 3: 1.0},
        "fingerprint_20": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fingerprint_21": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fingerprint_22": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fingerprint_23": {0: 1.0, 1: 0.0, 2: 0.0, 3: 1.0},
        "fingerprint_24": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fingerprint_25": {0: 1.0, 1: 0.0, 2: 0.0, 3: 1.0},
        "fingerprint_26": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fingerprint_27": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fingerprint_28": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fingerprint_29": {0: 1.0, 1: 0.0, 2: 0.0, 3: 1.0},
        "fingerprint_30": {0: 0.0, 1: 0.0, 2: 1.0, 3: 0.0},
        "fingerprint_31": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_Al_OH": {0: 0.0, 1: 0.0, 2: 1.0, 3: 0.0},
        "fr_Al_OH_noTert": {0: 0.0, 1: 0.0, 2: 1.0, 3: 0.0},
        "fr_ArN": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_Ar_COO": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_Ar_N": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_Ar_NH": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_Ar_OH": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_COO": {0: 1.0, 1: 0.0, 2: 0.0, 3: 1.0},
        "fr_COO2": {0: 1.0, 1: 0.0, 2: 0.0, 3: 1.0},
        "fr_C_O": {0: 2.0, 1: 0.0, 2: 0.0, 3: 1.0},
        "fr_C_O_noCOO": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_C_S": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_HOCCN": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_Imine": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_NH0": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_NH1": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_NH2": {0: 0.0, 1: 0.0, 2: 0.0, 3: 1.0},
        "fr_N_O": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_Ndealkylation1": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_Ndealkylation2": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_Nhpyrrole": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_SH": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_aldehyde": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_alkyl_carbamate": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_alkyl_halide": {0: 0.0, 1: 0.0, 2: 0.0, 3: 1.0},
        "fr_allylic_oxid": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_amide": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_amidine": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_aniline": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_aryl_methyl": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_azide": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_azo": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_barbitur": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_benzene": {0: 1.0, 1: 1.0, 2: 0.0, 3: 0.0},
        "fr_benzodiazepine": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_bicyclic": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_diazo": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_dihydropyridine": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_epoxide": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_ester": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_ether": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_furan": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_guanido": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_halogen": {0: 0.0, 1: 0.0, 2: 0.0, 3: 1.0},
        "fr_hdrzine": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_hdrzone": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_imidazole": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_imide": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_isocyan": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_isothiocyan": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_ketone": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_ketone_Topliss": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_lactam": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_lactone": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_methoxy": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_morpholine": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_nitrile": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_nitro": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_nitro_arom": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_nitro_arom_nonortho": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_nitroso": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_oxazole": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_oxime": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_para_hydroxylation": {0: 1.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_phenol": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_phenol_noOrthoHbond": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_phos_acid": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_phos_ester": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_piperdine": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_piperzine": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_priamide": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_prisulfonamd": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_pyridine": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_quatN": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_sulfide": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_sulfonamd": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_sulfone": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_term_acetylene": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_tetrazole": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_thiazole": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_thiocyan": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_thiophene": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_unbrch_alkane": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
        "fr_urea": {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0},
    }

    input_feature = MolecularInput(
        key="molecule", smiles=smiles, molfeatures=FingerprintsFragments(n_bits=32)
    )
    generated = input_feature.molfeatures(VALID_SMILES)
    assert_frame_equal(generated, pd.DataFrame.from_dict(values))


@pytest.mark.skipif(not RDKIT_AVAILABLE, reason="requires rdkit")
def test_molfeatures_type_mordreddescriptors():
    values = {
        "NssCH2": {
            0: 0.5963718820861676,
            1: -1.5,
            2: -0.28395061728395066,
            3: -8.34319526627219,
        },
        "ATSC2d": {0: 0.0, 1: 0.0, 2: 1.0, 3: 0.0},
    }

    input_feature = MolecularInput(
        key="molecule",
        smiles=smiles,
        molfeatures=MordredDescriptors(descriptors=["NssCH2", "ATSC2d"]),
    )
    generated = input_feature.molfeatures(VALID_SMILES)
    assert_frame_equal(generated, pd.DataFrame.from_dict(values))


# @pytest.mark.skipif(not RDKIT_AVAILABLE, reason="requires rdkit")
# def test_to_fingerprints():
#     m = MolecularInput(key="molecules")
#     data = m.to_fingerprints(VALID_SMILES)
#     assert data.shape[0] == 6
#     with pytest.raises(ValueError):
#         m.to_fingerprints(INVALID_SMILES)


# @pytest.mark.skipif(not RDKIT_AVAILABLE, reason="requires rdkit")
# def test_to_bag_of_characters():
#     m = MolecularInput(key="molecules")
#     data = m.to_bag_of_characters(VALID_SMILES)
#     assert data.shape[0] == 6
#     with pytest.raises(ValueError):
#         m.to_bag_of_characters(INVALID_SMILES)


# @pytest.mark.skipif(not RDKIT_AVAILABLE, reason="requires rdkit")
# def test_to_fragments():
#     m = MolecularInput(key="molecules")
#     data = m.to_fragments(VALID_SMILES)
#     assert data.shape[0] == 6
#     with pytest.raises(ValueError):
#         m.to_fragments(INVALID_SMILES)
