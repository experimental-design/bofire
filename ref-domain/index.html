
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://experimental-design.github.io/bofire/ref-domain/">
      
      
        <link rel="prev" href="../data_models_functionals/">
      
      
        <link rel="next" href="../ref-constraints/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-9.2.3">
    
    
      
        <title>Domain - BoFire</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.0e669242.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.85d0ee34.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#domain" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="BoFire" class="md-header__button md-logo" aria-label="BoFire" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            BoFire
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Domain
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_3" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_3">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/experimental-design/bofire" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    experimental-design/bofire
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="BoFire" class="md-nav__button md-logo" aria-label="BoFire" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    BoFire
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/experimental-design/bofire" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    experimental-design/bofire
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Install
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../getting_started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting started
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Examples
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Package Architecture
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Package Architecture
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../data_models_functionals/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Models vs Functional Components
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Domain
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Domain
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#bofire.data_models.domain.domain" class="md-nav__link">
    bofire.data_models.domain.domain
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bofire.data_models.domain.domain.Domain" class="md-nav__link">
    Domain
  </a>
  
    <nav class="md-nav" aria-label="Domain">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bofire.data_models.domain.domain.Domain.candidate_column_names" class="md-nav__link">
    candidate_column_names
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bofire.data_models.domain.domain.Domain.experiment_column_names" class="md-nav__link">
    experiment_column_names
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bofire.data_models.domain.domain.Domain.__json_encoder__" class="md-nav__link">
    __json_encoder__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bofire.data_models.domain.domain.Domain.aggregate_by_duplicates" class="md-nav__link">
    aggregate_by_duplicates()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bofire.data_models.domain.domain.Domain.coerce_invalids" class="md-nav__link">
    coerce_invalids()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bofire.data_models.domain.domain.Domain.describe_experiments" class="md-nav__link">
    describe_experiments()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bofire.data_models.domain.domain.Domain.get_constraint_reps_df" class="md-nav__link">
    get_constraint_reps_df()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bofire.data_models.domain.domain.Domain.get_feature" class="md-nav__link">
    get_feature()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bofire.data_models.domain.domain.Domain.get_feature_keys" class="md-nav__link">
    get_feature_keys()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bofire.data_models.domain.domain.Domain.get_feature_reps_df" class="md-nav__link">
    get_feature_reps_df()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bofire.data_models.domain.domain.Domain.get_features" class="md-nav__link">
    get_features()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bofire.data_models.domain.domain.Domain.get_nchoosek_combinations" class="md-nav__link">
    get_nchoosek_combinations()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bofire.data_models.domain.domain.Domain.validate_candidates" class="md-nav__link">
    validate_candidates()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bofire.data_models.domain.domain.Domain.validate_constraints" class="md-nav__link">
    validate_constraints()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bofire.data_models.domain.domain.Domain.validate_experiments" class="md-nav__link">
    validate_experiments()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bofire.data_models.domain.domain.Domain.validate_linear_constraints" class="md-nav__link">
    validate_linear_constraints()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bofire.data_models.domain.domain.Domain.validate_unique_feature_keys" class="md-nav__link">
    validate_unique_feature_keys()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../ref-constraints/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Constraints
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../ref-objectives/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Objectives
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../ref-features/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Features
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../ref-domain-util/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Domain Util
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../ref-mappers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mappers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../ref-utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="domain">Domain</h1>


  <div class="doc doc-object doc-module">

<a id="bofire.data_models.domain.domain"></a>
    <div class="doc doc-contents first">




  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h2 id="bofire.data_models.domain.domain.Domain" class="doc doc-heading">
        <code>
Domain            (<span title="bofire.data_models.base.BaseModel">BaseModel</span>)
        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-pydantic-model"><code>pydantic-model</code></small>
  </span>

</h2>

    <div class="doc doc-contents ">


        <details class="quote">
          <summary>Source code in <code>bofire/data_models/domain/domain.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Domain</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="nb">type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;Domain&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Domain&quot;</span>

    <span class="n">inputs</span><span class="p">:</span> <span class="n">Inputs</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">Inputs</span><span class="p">())</span>
    <span class="n">outputs</span><span class="p">:</span> <span class="n">Outputs</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">Outputs</span><span class="p">())</span>

    <span class="n">constraints</span><span class="p">:</span> <span class="n">Constraints</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">Constraints</span><span class="p">())</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;Representation of the optimization problem/domain</span>

<span class="sd">    Attributes:</span>
<span class="sd">        inputs (List[Input], optional): List of input features. Defaults to [].</span>
<span class="sd">        outputs (List[Output], optional): List of output features. Defaults to [].</span>
<span class="sd">        constraints (List[Constraint], optional): List of constraints. Defaults to [].</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_lists</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">inputs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">AnyInput</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">outputs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">AnyOutput</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">constraints</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">AnyConstraint</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">inputs</span> <span class="o">=</span> <span class="p">[]</span> <span class="k">if</span> <span class="n">inputs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">inputs</span>
        <span class="n">outputs</span> <span class="o">=</span> <span class="p">[]</span> <span class="k">if</span> <span class="n">outputs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">outputs</span>
        <span class="n">constraints</span> <span class="o">=</span> <span class="p">[]</span> <span class="k">if</span> <span class="n">constraints</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">constraints</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
            <span class="n">inputs</span><span class="o">=</span><span class="n">Inputs</span><span class="p">(</span><span class="n">features</span><span class="o">=</span><span class="n">inputs</span><span class="p">),</span>
            <span class="n">outputs</span><span class="o">=</span><span class="n">Outputs</span><span class="p">(</span><span class="n">features</span><span class="o">=</span><span class="n">outputs</span><span class="p">),</span>
            <span class="n">constraints</span><span class="o">=</span><span class="n">Constraints</span><span class="p">(</span><span class="n">constraints</span><span class="o">=</span><span class="n">constraints</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="nd">@validator</span><span class="p">(</span><span class="s2">&quot;inputs&quot;</span><span class="p">,</span> <span class="n">always</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pre</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">validate_inputs_list</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Sequence</span><span class="p">):</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">Inputs</span><span class="p">(</span><span class="n">features</span><span class="o">=</span><span class="n">v</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">v</span>
        <span class="k">if</span> <span class="n">isinstance_or_union</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">AnyInput</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Inputs</span><span class="p">(</span><span class="n">features</span><span class="o">=</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">v</span>

    <span class="nd">@validator</span><span class="p">(</span><span class="s2">&quot;outputs&quot;</span><span class="p">,</span> <span class="n">always</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pre</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">validate_outputs_list</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">Sequence</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Outputs</span><span class="p">(</span><span class="n">features</span><span class="o">=</span><span class="n">v</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">isinstance_or_union</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">AnyOutput</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Outputs</span><span class="p">(</span><span class="n">features</span><span class="o">=</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">v</span>

    <span class="nd">@validator</span><span class="p">(</span><span class="s2">&quot;constraints&quot;</span><span class="p">,</span> <span class="n">always</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pre</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">validate_constraints_list</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Constraints</span><span class="p">(</span><span class="n">constraints</span><span class="o">=</span><span class="n">v</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">isinstance_or_union</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">AnyConstraint</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Constraints</span><span class="p">(</span><span class="n">constraints</span><span class="o">=</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">v</span>

    <span class="nd">@validator</span><span class="p">(</span><span class="s2">&quot;outputs&quot;</span><span class="p">,</span> <span class="n">always</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">validate_unique_feature_keys</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="n">Outputs</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Outputs</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validates if provided input and output feature keys are unique</span>

<span class="sd">        Args:</span>
<span class="sd">            v (Outputs): List of all output features of the domain.</span>
<span class="sd">            value (Dict[str, Inputs]): Dict containing a list of input features as single entry.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: Feature keys are not unique.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Outputs: Keeps output features as given.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;inputs&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">v</span>
        <span class="n">features</span> <span class="o">=</span> <span class="n">v</span> <span class="o">+</span> <span class="n">values</span><span class="p">[</span><span class="s2">&quot;inputs&quot;</span><span class="p">]</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">key</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">features</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">keys</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;feature keys are not unique&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">v</span>

    <span class="nd">@validator</span><span class="p">(</span><span class="s2">&quot;constraints&quot;</span><span class="p">,</span> <span class="n">always</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">validate_constraints</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate if all features included in the constraints are also defined as features for the domain.</span>

<span class="sd">        Args:</span>
<span class="sd">            v (List[Constraint]): List of constraints or empty if no constraints are defined</span>
<span class="sd">            values (List[Input]): List of input features of the domain</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: Feature key in constraint is unknown.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List[Constraint]: List of constraints defined for the domain</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;inputs&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">v</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">key</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">values</span><span class="p">[</span><span class="s2">&quot;inputs&quot;</span><span class="p">]]</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">LinearConstraint</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">NChooseKConstraint</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">c</span><span class="o">.</span><span class="n">features</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">f</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;feature </span><span class="si">{</span><span class="n">f</span><span class="si">}</span><span class="s2"> in constraint unknown (</span><span class="si">{</span><span class="n">keys</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">v</span>

    <span class="nd">@validator</span><span class="p">(</span><span class="s2">&quot;constraints&quot;</span><span class="p">,</span> <span class="n">always</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">validate_linear_constraints</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate if all features included in linear constraints are continuous ones.</span>

<span class="sd">        Args:</span>
<span class="sd">            v (List[Constraint]): List of constraints or empty if no constraints are defined</span>
<span class="sd">            values (List[Input]): List of input features of the domain</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: _description_</span>


<span class="sd">        Returns:</span>
<span class="sd">           List[Constraint]: List of constraints defined for the domain</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;inputs&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">v</span>

        <span class="c1"># gather continuous inputs in dictionary</span>
        <span class="n">continuous_inputs_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">values</span><span class="p">[</span><span class="s2">&quot;inputs&quot;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ContinuousInput</span><span class="p">):</span>
                <span class="n">continuous_inputs_dict</span><span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span>

        <span class="c1"># check if non continuous input features appear in linear constraints</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">LinearConstraint</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">c</span><span class="o">.</span><span class="n">features</span><span class="p">:</span>
                    <span class="k">assert</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">continuous_inputs_dict</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">f</span><span class="si">}</span><span class="s2"> must be continuous.&quot;</span>
        <span class="k">return</span> <span class="n">v</span>

    <span class="k">def</span> <span class="nf">get_feature_reps_df</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a pandas dataframe describing the features contained in the optimization domain.&quot;&quot;&quot;</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_feature_keys</span><span class="p">(</span><span class="n">Feature</span><span class="p">),</span>
            <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Type&quot;</span><span class="p">,</span> <span class="s2">&quot;Description&quot;</span><span class="p">],</span>
            <span class="n">data</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;Type&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="n">feat</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="k">for</span> <span class="n">feat</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_features</span><span class="p">(</span><span class="n">Feature</span><span class="p">)</span>
                <span class="p">],</span>
                <span class="s2">&quot;Description&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">feat</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span> <span class="k">for</span> <span class="n">feat</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_features</span><span class="p">(</span><span class="n">Feature</span><span class="p">)],</span>
            <span class="p">},</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">df</span>

    <span class="k">def</span> <span class="nf">get_constraint_reps_df</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Provides a tabular overwiev of all constraints within the domain</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: DataFrame listing all constraints of the domain with a description</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="n">index</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">constraints</span><span class="p">)),</span>
            <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Type&quot;</span><span class="p">,</span> <span class="s2">&quot;Description&quot;</span><span class="p">],</span>
            <span class="n">data</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;Type&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">feat</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="k">for</span> <span class="n">feat</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">constraints</span><span class="p">],</span>
                <span class="s2">&quot;Description&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="n">constraint</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span> <span class="k">for</span> <span class="n">constraint</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">constraints</span>
                <span class="p">],</span>
            <span class="p">},</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">df</span>

    <span class="k">def</span> <span class="nf">get_features</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">includes</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="n">Feature</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="n">Feature</span><span class="p">]]]</span> <span class="o">=</span> <span class="n">Feature</span><span class="p">,</span>
        <span class="n">excludes</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="n">Feature</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="n">Feature</span><span class="p">]],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">exact</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Features</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;get features of the domain</span>

<span class="sd">        Args:</span>
<span class="sd">            includes (Union[Type, List[Type]], optional): Feature class or list of specific feature classes to be returned. Defaults to Feature.</span>
<span class="sd">            excludes (Union[Type, List[Type]], optional): Feature class or list of specific feature classes to be excluded from the return. Defaults to None.</span>
<span class="sd">            exact (bool, optional): Boolean to distinguish if only the exact class listed in includes and no subclasses inherenting from this class shall be returned. Defaults to False.</span>
<span class="sd">            by_attribute (str, optional): If set it is filtered by the attribute specified in by `by_attribute`. Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List[Feature]: List of features in the domain fitting to the passed requirements.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="n">Inputs</span><span class="p">)</span>
        <span class="n">features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span>
        <span class="k">return</span> <span class="n">features</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">includes</span><span class="p">,</span> <span class="n">excludes</span><span class="p">,</span> <span class="n">exact</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_feature_keys</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">includes</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Type</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Type</span><span class="p">]]</span> <span class="o">=</span> <span class="n">Feature</span><span class="p">,</span>
        <span class="n">excludes</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Type</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Type</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">exact</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Method to get feature keys of the domain</span>

<span class="sd">        Args:</span>
<span class="sd">            includes (Union[Type, List[Type]], optional): Feature class or list of specific feature classes to be returned. Defaults to Feature.</span>
<span class="sd">            excludes (Union[Type, List[Type]], optional): Feature class or list of specific feature classes to be excluded from the return. Defaults to None.</span>
<span class="sd">            exact (bool, optional): Boolean to distinguish if only the exact class listed in includes and no subclasses inherenting from this class shall be returned. Defaults to False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List[str]: List of feature keys fitting to the passed requirements.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="n">f</span><span class="o">.</span><span class="n">key</span>
            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_features</span><span class="p">(</span>
                <span class="n">includes</span><span class="o">=</span><span class="n">includes</span><span class="p">,</span>
                <span class="n">excludes</span><span class="o">=</span><span class="n">excludes</span><span class="p">,</span>
                <span class="n">exact</span><span class="o">=</span><span class="n">exact</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">]</span>

    <span class="k">def</span> <span class="nf">get_feature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;get a specific feature by its key</span>

<span class="sd">        Args:</span>
<span class="sd">            key (str): Feature key</span>

<span class="sd">        Returns:</span>
<span class="sd">            Feature: The feature with the passed key</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="n">Inputs</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span><span class="n">f</span><span class="o">.</span><span class="n">key</span><span class="p">:</span> <span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">}[</span><span class="n">key</span><span class="p">]</span>

    <span class="c1"># TODO: tidy this up</span>
    <span class="k">def</span> <span class="nf">get_nchoosek_combinations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exhaustive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>  <span class="c1"># noqa: C901</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;get all possible NChooseK combinations</span>

<span class="sd">        Args:</span>
<span class="sd">            exhaustive (bool, optional): if True all combinations are returned. Defaults to False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tuple(used_features_list, unused_features_list): used_features_list is a list of lists containing features used in each NChooseK combination.</span>
<span class="sd">                unused_features_list is a list of lists containing features unused in each NChooseK combination.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">constraints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">NChooseKConstraint</span><span class="p">))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">used_continuous_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature_keys</span><span class="p">(</span><span class="n">ContinuousInput</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">used_continuous_features</span><span class="p">,</span> <span class="p">[]</span>

        <span class="n">used_features_list_all</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># loops through each NChooseK constraint</span>
        <span class="k">for</span> <span class="n">con</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">constraints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">NChooseKConstraint</span><span class="p">):</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">con</span><span class="p">,</span> <span class="n">NChooseKConstraint</span><span class="p">)</span>
            <span class="n">used_features_list</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">if</span> <span class="n">exhaustive</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">min_count</span><span class="p">,</span> <span class="n">con</span><span class="o">.</span><span class="n">max_count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="n">used_features_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">features</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>

                <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">none_also_valid</span><span class="p">:</span>
                    <span class="n">used_features_list</span><span class="o">.</span><span class="n">append</span><span class="p">(())</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">used_features_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                    <span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">features</span><span class="p">,</span> <span class="n">con</span><span class="o">.</span><span class="n">max_count</span><span class="p">)</span>
                <span class="p">)</span>

            <span class="n">used_features_list_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">used_features_list</span><span class="p">)</span>

        <span class="n">used_features_list_all</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
            <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">used_features_list_all</span><span class="p">)</span>
        <span class="p">)</span>  <span class="c1"># product between NChooseK constraints</span>

        <span class="c1"># format into a list of used features</span>
        <span class="n">used_features_list_formatted</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">used_features_list</span> <span class="ow">in</span> <span class="n">used_features_list_all</span><span class="p">:</span>
            <span class="n">used_features_list_flattened</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">item</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">used_features_list</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span>
            <span class="p">]</span>
            <span class="n">used_features_list_formatted</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">used_features_list_flattened</span><span class="p">)))</span>

        <span class="c1"># sort lists</span>
        <span class="n">used_features_list_sorted</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">used_features</span> <span class="ow">in</span> <span class="n">used_features_list_formatted</span><span class="p">:</span>
            <span class="n">used_features_list_sorted</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">used_features</span><span class="p">))</span>

        <span class="c1"># drop duplicates</span>
        <span class="n">used_features_list_no_dup</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">used_features</span> <span class="ow">in</span> <span class="n">used_features_list_sorted</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">used_features</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">used_features_list_no_dup</span><span class="p">:</span>
                <span class="n">used_features_list_no_dup</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">used_features</span><span class="p">)</span>

        <span class="c1"># print(f&quot;duplicates dropped: {len(used_features_list_sorted)-len(used_features_list_no_dup)}&quot;)</span>

        <span class="c1"># remove combinations not fulfilling constraints</span>
        <span class="n">used_features_list_final</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">combo</span> <span class="ow">in</span> <span class="n">used_features_list_no_dup</span><span class="p">:</span>
            <span class="n">fulfil_constraints</span> <span class="o">=</span> <span class="p">(</span>
                <span class="p">[]</span>
            <span class="p">)</span>  <span class="c1"># list of bools tracking if constraints are fulfilled</span>
            <span class="k">for</span> <span class="n">con</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">constraints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">NChooseKConstraint</span><span class="p">):</span>
                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">con</span><span class="p">,</span> <span class="n">NChooseKConstraint</span><span class="p">)</span>
                <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># count of features in combo that are in con.features</span>
                <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">combo</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">con</span><span class="o">.</span><span class="n">features</span><span class="p">:</span>
                        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;=</span> <span class="n">con</span><span class="o">.</span><span class="n">min_count</span> <span class="ow">and</span> <span class="n">count</span> <span class="o">&lt;=</span> <span class="n">con</span><span class="o">.</span><span class="n">max_count</span><span class="p">:</span>
                    <span class="n">fulfil_constraints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">con</span><span class="o">.</span><span class="n">none_also_valid</span><span class="p">:</span>
                    <span class="n">fulfil_constraints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">fulfil_constraints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">fulfil_constraints</span><span class="p">):</span>
                <span class="n">used_features_list_final</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">combo</span><span class="p">)</span>

        <span class="c1"># print(f&quot;violators dropped: {len(used_features_list_no_dup)-len(used_features_list_final)}&quot;)</span>

        <span class="c1"># features unused</span>
        <span class="n">features_in_cc</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">con</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">constraints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">NChooseKConstraint</span><span class="p">):</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">con</span><span class="p">,</span> <span class="n">NChooseKConstraint</span><span class="p">)</span>
            <span class="n">features_in_cc</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">features</span><span class="p">)</span>
        <span class="n">features_in_cc</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">features_in_cc</span><span class="p">))</span>
        <span class="n">features_in_cc</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">unused_features_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">used_features</span> <span class="ow">in</span> <span class="n">used_features_list_final</span><span class="p">:</span>
            <span class="n">unused_features_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">[</span><span class="n">f_key</span> <span class="k">for</span> <span class="n">f_key</span> <span class="ow">in</span> <span class="n">features_in_cc</span> <span class="k">if</span> <span class="n">f_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">used_features</span><span class="p">]</span>
            <span class="p">)</span>

        <span class="c1"># postprocess</span>
        <span class="c1"># used_features_list_final2 = []</span>
        <span class="c1"># unused_features_list2 = []</span>
        <span class="c1"># for used, unused in zip(used_features_list_final,unused_features_list):</span>
        <span class="c1">#     if len(used) == 3:</span>
        <span class="c1">#         used_features_list_final2.append(used), unused_features_list2.append(unused)</span>

        <span class="k">return</span> <span class="n">used_features_list_final</span><span class="p">,</span> <span class="n">unused_features_list</span>

    <span class="k">def</span> <span class="nf">coerce_invalids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">experiments</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Coerces all invalid output measurements to np.nan</span>

<span class="sd">        Args:</span>
<span class="sd">            experiments (pd.DataFrame): Dataframe containing experimental data</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: coerced dataframe</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># coerce invalid to nan</span>
        <span class="k">for</span> <span class="n">feat</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature_keys</span><span class="p">(</span><span class="n">Output</span><span class="p">):</span>
            <span class="n">experiments</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">experiments</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;valid_</span><span class="si">{</span><span class="n">feat</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">feat</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">return</span> <span class="n">experiments</span>

    <span class="k">def</span> <span class="nf">aggregate_by_duplicates</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">experiments</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">prec</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">delimiter</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Aggregate the dataframe by duplicate experiments</span>

<span class="sd">        Duplicates are identified based on the experiments with the same input features. Continuous input features</span>
<span class="sd">        are rounded before identifying the duplicates. Aggregation is performed by taking the average of the</span>
<span class="sd">        involved output features.</span>

<span class="sd">        Args:</span>
<span class="sd">            experiments (pd.DataFrame): Dataframe containing experimental data</span>
<span class="sd">            prec (int): Precision of the rounding of the continuous input features</span>
<span class="sd">            delimiter (str, optional): Delimiter used when combining the orig. labcodes to a new one. Defaults to &quot;-&quot;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tuple[pd.DataFrame, list]: Dataframe holding the aggregated experiments, list of lists holding the labcodes of the duplicates</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># prepare the parent frame</span>

        <span class="n">preprocessed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">preprocess_experiments_any_valid_output</span><span class="p">(</span><span class="n">experiments</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">preprocessed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="n">experiments</span> <span class="o">=</span> <span class="n">preprocessed</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">if</span> <span class="s2">&quot;labcode&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">experiments</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">experiments</span><span class="p">[</span><span class="s2">&quot;labcode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">experiments</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))))</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">experiments</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="p">]</span>

        <span class="c1"># round it</span>
        <span class="n">experiments</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_feature_keys</span><span class="p">(</span><span class="n">ContinuousInput</span><span class="p">)]</span> <span class="o">=</span> <span class="n">experiments</span><span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_feature_keys</span><span class="p">(</span><span class="n">ContinuousInput</span><span class="p">)</span>
        <span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span>

        <span class="c1"># coerce invalid to nan</span>
        <span class="n">experiments</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coerce_invalids</span><span class="p">(</span><span class="n">experiments</span><span class="p">)</span>

        <span class="c1"># group and aggregate</span>
        <span class="n">agg</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">feat</span><span class="p">:</span> <span class="s2">&quot;mean&quot;</span> <span class="k">for</span> <span class="n">feat</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature_keys</span><span class="p">(</span><span class="n">ContinuousOutput</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="n">agg</span><span class="p">[</span><span class="s2">&quot;labcode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">delimiter</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>
        <span class="k">for</span> <span class="n">feat</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature_keys</span><span class="p">(</span><span class="n">Output</span><span class="p">):</span>
            <span class="n">agg</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;valid_</span><span class="si">{</span><span class="n">feat</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span>

        <span class="n">grouped</span> <span class="o">=</span> <span class="n">experiments</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_feature_keys</span><span class="p">(</span><span class="n">Input</span><span class="p">))</span>
        <span class="n">duplicated_labcodes</span> <span class="o">=</span> <span class="p">[</span>
            <span class="nb">sorted</span><span class="p">(</span><span class="n">group</span><span class="o">.</span><span class="n">labcode</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped</span>
            <span class="k">if</span> <span class="n">group</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span>
        <span class="p">]</span>

        <span class="n">experiments</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">agg</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">feat</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature_keys</span><span class="p">(</span><span class="n">Output</span><span class="p">):</span>
            <span class="n">experiments</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">experiments</span><span class="p">[</span><span class="n">feat</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">(),</span> <span class="sa">f</span><span class="s2">&quot;valid_</span><span class="si">{</span><span class="n">feat</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">experiments</span> <span class="o">=</span> <span class="n">experiments</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;labcode&quot;</span><span class="p">)</span>
        <span class="n">experiments</span> <span class="o">=</span> <span class="n">experiments</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">experiments</span><span class="p">,</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">duplicated_labcodes</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">validate_experiments</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">experiments</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
        <span class="n">strict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;checks the experimental data on validity</span>

<span class="sd">        Args:</span>
<span class="sd">            experiments (pd.DataFrame): Dataframe with experimental data</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: empty dataframe</span>
<span class="sd">            ValueError: the column for a specific feature is missing the provided data</span>
<span class="sd">            ValueError: there are labcodes with null value</span>
<span class="sd">            ValueError: there are labcodes with nan value</span>
<span class="sd">            ValueError: labcodes are not unique</span>
<span class="sd">            ValueError: the provided columns do no match to the defined domain</span>
<span class="sd">            ValueError: the provided columns do no match to the defined domain</span>
<span class="sd">            ValueError: Input with null values</span>
<span class="sd">            ValueError: Input with nan values</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: The provided dataframe with experimental data</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">experiments</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;no experiments provided (empty dataframe)&quot;</span><span class="p">)</span>
        <span class="c1"># check that each feature is a col</span>
        <span class="n">feature_keys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature_keys</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">feature_key</span> <span class="ow">in</span> <span class="n">feature_keys</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">feature_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">experiments</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;no col in experiments for feature </span><span class="si">{</span><span class="n">feature_key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># add valid_{key} cols if missing</span>
        <span class="n">valid_keys</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sa">f</span><span class="s2">&quot;valid_</span><span class="si">{</span><span class="n">output_feature_key</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">for</span> <span class="n">output_feature_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature_keys</span><span class="p">(</span><span class="n">Output</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">valid_key</span> <span class="ow">in</span> <span class="n">valid_keys</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">valid_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">experiments</span><span class="p">:</span>
                <span class="n">experiments</span><span class="p">[</span><span class="n">valid_key</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># check all cols</span>
        <span class="n">cols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">experiments</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
        <span class="c1"># we allow here for a column named labcode used to identify experiments</span>
        <span class="k">if</span> <span class="s2">&quot;labcode&quot;</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
            <span class="c1"># test that labcodes are not na</span>
            <span class="k">if</span> <span class="n">experiments</span><span class="o">.</span><span class="n">labcode</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;there are labcodes with null value&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">experiments</span><span class="o">.</span><span class="n">labcode</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;there are labcodes with nan value&quot;</span><span class="p">)</span>
            <span class="c1"># test that labcodes are distinct</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">experiments</span><span class="o">.</span><span class="n">labcode</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>
                <span class="o">!=</span> <span class="n">experiments</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;labcodes are not unique&quot;</span><span class="p">)</span>
            <span class="c1"># we remove the labcode from the cols list to proceed as before</span>
            <span class="n">cols</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;labcode&quot;</span><span class="p">)</span>
        <span class="c1"># check values of continuous input features</span>
        <span class="k">if</span> <span class="n">experiments</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_feature_keys</span><span class="p">(</span><span class="n">Input</span><span class="p">)]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;there are null values&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">experiments</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_feature_keys</span><span class="p">(</span><span class="n">Input</span><span class="p">)]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;there are na values&quot;</span><span class="p">)</span>
        <span class="c1"># run the individual validators</span>
        <span class="k">for</span> <span class="n">feat</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_features</span><span class="p">(</span><span class="n">Input</span><span class="p">):</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">feat</span><span class="p">,</span> <span class="n">Input</span><span class="p">)</span>
            <span class="n">feat</span><span class="o">.</span><span class="n">validate_experimental</span><span class="p">(</span><span class="n">experiments</span><span class="p">[</span><span class="n">feat</span><span class="o">.</span><span class="n">key</span><span class="p">],</span> <span class="n">strict</span><span class="o">=</span><span class="n">strict</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">experiments</span>

    <span class="k">def</span> <span class="nf">describe_experiments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">experiments</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Method to get a tabular overview of how many measurements and how many valid entries are included in the input data for each output feature</span>

<span class="sd">        Args:</span>
<span class="sd">            experiments (pd.DataFrame): Dataframe with experimental data</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: Dataframe with counts how many measurements and how many valid entries are included in the input data for each output feature</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">feat</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature_keys</span><span class="p">(</span><span class="n">Output</span><span class="p">):</span>
            <span class="n">data</span><span class="p">[</span><span class="n">feat</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">experiments</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">experiments</span><span class="p">[</span><span class="n">feat</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">experiments</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">experiments</span><span class="p">[</span><span class="n">feat</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">(),</span> <span class="s2">&quot;valid_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">feat</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span>
            <span class="p">]</span>
        <span class="n">preprocessed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">preprocess_experiments_all_valid_outputs</span><span class="p">(</span>
            <span class="n">experiments</span>
        <span class="p">)</span>
        <span class="k">assert</span> <span class="n">preprocessed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;all&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">experiments</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">preprocessed</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span>
            <span class="n">data</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;measured&quot;</span><span class="p">,</span> <span class="s2">&quot;valid&quot;</span><span class="p">]</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">validate_candidates</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">candidates</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
        <span class="n">only_inputs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-5</span><span class="p">,</span>
        <span class="n">raise_validation_error</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Method to check the validty of porposed candidates</span>

<span class="sd">        Args:</span>
<span class="sd">            candidates (pd.DataFrame): Dataframe with suggested new experiments (candidates)</span>
<span class="sd">            only_inputs (bool,optional): If True, only the input columns are validated. Defaults to False.</span>
<span class="sd">            tol (float,optional): tolerance parameter for constraints. A constraint is considered as not fulfilled if the violation</span>
<span class="sd">                is larger than tol. Defaults to 1e-6.</span>
<span class="sd">            raise_validation_error (bool, optional): If true an error will be raised if candidates violate constraints,</span>
<span class="sd">                otherwise only a warning will be displayed. Defaults to True.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: when a column is missing for a defined input feature</span>
<span class="sd">            ValueError: when a column is missing for a defined output feature</span>
<span class="sd">            ValueError: when a non-numerical value is proposed</span>
<span class="sd">            ValueError: when an additional column is found</span>
<span class="sd">            ConstraintNotFulfilledError: when the constraints are not fulfilled and `raise_validation_error = True`</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: dataframe with suggested experiments (candidates)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check that each input feature has a col and is valid in itself</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="n">Inputs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">validate_inputs</span><span class="p">(</span><span class="n">candidates</span><span class="p">)</span>
        <span class="c1"># check if all constraints are fulfilled</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">constraints</span><span class="o">.</span><span class="n">is_fulfilled</span><span class="p">(</span><span class="n">candidates</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="n">tol</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">raise_validation_error</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ConstraintNotFulfilledError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Constraints not fulfilled: </span><span class="si">{</span><span class="n">candidates</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Not all constraints are fulfilled.&quot;</span><span class="p">)</span>
        <span class="c1"># for each continuous output feature with an attached objective object</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">only_inputs</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">,</span> <span class="n">Outputs</span><span class="p">)</span>

            <span class="n">cols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">_pred&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">_sd&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">_des&quot;</span><span class="p">]</span>
                        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">get_keys_by_objective</span><span class="p">(</span><span class="n">Objective</span><span class="p">)</span>
                    <span class="p">]</span>
                    <span class="o">+</span> <span class="p">[</span>
                        <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">_pred&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">_sd&quot;</span><span class="p">]</span>
                        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">get_keys_by_objective</span><span class="p">(</span>
                            <span class="n">excludes</span><span class="o">=</span><span class="n">Objective</span><span class="p">,</span> <span class="n">includes</span><span class="o">=</span><span class="kc">None</span>  <span class="c1"># type: ignore</span>
                        <span class="p">)</span>
                    <span class="p">]</span>
                <span class="p">)</span>
            <span class="p">)</span>

            <span class="c1"># check that pred, sd, and des cols are specified and numerical</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;missing column </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">is_numeric</span><span class="p">(</span><span class="n">candidates</span><span class="p">[</span><span class="n">col</span><span class="p">]))</span> <span class="ow">and</span> <span class="p">(</span>
                    <span class="ow">not</span> <span class="n">candidates</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
                <span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;not all values of column `</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">` are numerical&quot;</span><span class="p">)</span>

            <span class="c1"># validate no additional cols exist</span>
            <span class="n">if_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_features</span><span class="p">(</span><span class="n">Input</span><span class="p">))</span>
            <span class="n">of_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">get_by_objective</span><span class="p">(</span><span class="n">includes</span><span class="o">=</span><span class="n">Objective</span><span class="p">))</span>
            <span class="n">of_count_w</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">get_by_objective</span><span class="p">(</span><span class="n">excludes</span><span class="o">=</span><span class="n">Objective</span><span class="p">,</span> <span class="n">includes</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>  <span class="c1"># type: ignore</span>
            <span class="c1"># input features, prediction, standard deviation and reward for each output feature, 3 additional usefull infos: reward, aquisition function, strategy</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidates</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">!=</span> <span class="n">if_count</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">of_count</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">of_count_w</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;additional columns found&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">candidates</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">experiment_column_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;the columns in the experimental dataframe</span>

<span class="sd">        Returns:</span>
<span class="sd">            List[str]: List of columns in the experiment dataframe (output feature keys + valid_output feature keys)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature_keys</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span>
            <span class="sa">f</span><span class="s2">&quot;valid_</span><span class="si">{</span><span class="n">output_feature_key</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">for</span> <span class="n">output_feature_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature_keys</span><span class="p">(</span><span class="n">Output</span><span class="p">)</span>
        <span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">candidate_column_names</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;the columns in the candidate dataframe</span>

<span class="sd">        Returns:</span>
<span class="sd">            List[str]: List of columns in the candidate dataframe (input feature keys + input feature keys_pred, input feature keys_sd, input feature keys_des)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">,</span> <span class="n">Outputs</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_feature_keys</span><span class="p">(</span><span class="n">Input</span><span class="p">)</span>
            <span class="o">+</span> <span class="p">[</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">output_feature_key</span><span class="si">}</span><span class="s2">_pred&quot;</span>
                <span class="k">for</span> <span class="n">output_feature_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">get_keys_by_objective</span><span class="p">(</span><span class="n">Objective</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="o">+</span> <span class="p">[</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">output_feature_key</span><span class="si">}</span><span class="s2">_sd&quot;</span>
                <span class="k">for</span> <span class="n">output_feature_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">get_keys_by_objective</span><span class="p">(</span><span class="n">Objective</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="o">+</span> <span class="p">[</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">output_feature_key</span><span class="si">}</span><span class="s2">_des&quot;</span>
                <span class="k">for</span> <span class="n">output_feature_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">get_keys_by_objective</span><span class="p">(</span><span class="n">Objective</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_constraints_unvalidated</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">constraints</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Sequence</span><span class="p">[</span><span class="n">AnyConstraint</span><span class="p">],</span> <span class="n">Constraints</span><span class="p">]</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Hack for reduce_domain&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">constraints</span> <span class="o">=</span> <span class="n">Constraints</span><span class="p">(</span><span class="n">constraints</span><span class="o">=</span><span class="p">[])</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">constraints</span><span class="p">,</span> <span class="n">Constraints</span><span class="p">):</span>
            <span class="n">constraints</span> <span class="o">=</span> <span class="n">constraints</span><span class="o">.</span><span class="n">constraints</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">constraints</span><span class="o">.</span><span class="n">constraints</span> <span class="o">=</span> <span class="n">constraints</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h3 id="bofire.data_models.domain.domain.Domain.candidate_column_names" class="doc doc-heading">
<code class="highlight language-python"><span class="n">candidate_column_names</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>the columns in the candidate dataframe</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[str]</code></td>
      <td><p>List of columns in the candidate dataframe (input feature keys + input feature keys_pred, input feature keys_sd, input feature keys_des)</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>




  <div class="doc doc-object doc-attribute">



<h3 id="bofire.data_models.domain.domain.Domain.experiment_column_names" class="doc doc-heading">
<code class="highlight language-python"><span class="n">experiment_column_names</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>the columns in the experimental dataframe</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[str]</code></td>
      <td><p>List of columns in the experiment dataframe (output feature keys + valid_output feature keys)</p></td>
    </tr>
  </tbody>
</table>    </div>

  </div>










  <div class="doc doc-object doc-method">



<h3 id="bofire.data_models.domain.domain.Domain.__json_encoder__" class="doc doc-heading">
<code class="highlight language-python"><span class="n">__json_encoder__</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
      <small class="doc doc-property doc-property-staticmethod"><code>staticmethod</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>partial(func, <em>args, </em>*keywords) - new function with partial application
of the given arguments and keywords.</p>

    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="bofire.data_models.domain.domain.Domain.aggregate_by_duplicates" class="doc doc-heading">
<code class="highlight language-python"><span class="n">aggregate_by_duplicates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">experiments</span><span class="p">,</span> <span class="n">prec</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Aggregate the dataframe by duplicate experiments</p>
<p>Duplicates are identified based on the experiments with the same input features. Continuous input features
are rounded before identifying the duplicates. Aggregation is performed by taking the average of the
involved output features.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>experiments</code></td>
        <td><code>pd.DataFrame</code></td>
        <td><p>Dataframe containing experimental data</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>prec</code></td>
        <td><code>int</code></td>
        <td><p>Precision of the rounding of the continuous input features</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>delimiter</code></td>
        <td><code>str</code></td>
        <td><p>Delimiter used when combining the orig. labcodes to a new one. Defaults to "-".</p></td>
        <td><code>&#39;-&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Tuple[pd.DataFrame, list]</code></td>
      <td><p>Dataframe holding the aggregated experiments, list of lists holding the labcodes of the duplicates</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>bofire/data_models/domain/domain.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">aggregate_by_duplicates</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">experiments</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">prec</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">delimiter</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Aggregate the dataframe by duplicate experiments</span>

<span class="sd">    Duplicates are identified based on the experiments with the same input features. Continuous input features</span>
<span class="sd">    are rounded before identifying the duplicates. Aggregation is performed by taking the average of the</span>
<span class="sd">    involved output features.</span>

<span class="sd">    Args:</span>
<span class="sd">        experiments (pd.DataFrame): Dataframe containing experimental data</span>
<span class="sd">        prec (int): Precision of the rounding of the continuous input features</span>
<span class="sd">        delimiter (str, optional): Delimiter used when combining the orig. labcodes to a new one. Defaults to &quot;-&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple[pd.DataFrame, list]: Dataframe holding the aggregated experiments, list of lists holding the labcodes of the duplicates</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># prepare the parent frame</span>

    <span class="n">preprocessed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">preprocess_experiments_any_valid_output</span><span class="p">(</span><span class="n">experiments</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">preprocessed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
    <span class="n">experiments</span> <span class="o">=</span> <span class="n">preprocessed</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">if</span> <span class="s2">&quot;labcode&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">experiments</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">experiments</span><span class="p">[</span><span class="s2">&quot;labcode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">experiments</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))))</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">experiments</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="p">]</span>

    <span class="c1"># round it</span>
    <span class="n">experiments</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_feature_keys</span><span class="p">(</span><span class="n">ContinuousInput</span><span class="p">)]</span> <span class="o">=</span> <span class="n">experiments</span><span class="p">[</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_feature_keys</span><span class="p">(</span><span class="n">ContinuousInput</span><span class="p">)</span>
    <span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span>

    <span class="c1"># coerce invalid to nan</span>
    <span class="n">experiments</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coerce_invalids</span><span class="p">(</span><span class="n">experiments</span><span class="p">)</span>

    <span class="c1"># group and aggregate</span>
    <span class="n">agg</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">feat</span><span class="p">:</span> <span class="s2">&quot;mean&quot;</span> <span class="k">for</span> <span class="n">feat</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature_keys</span><span class="p">(</span><span class="n">ContinuousOutput</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="n">agg</span><span class="p">[</span><span class="s2">&quot;labcode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">delimiter</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>
    <span class="k">for</span> <span class="n">feat</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature_keys</span><span class="p">(</span><span class="n">Output</span><span class="p">):</span>
        <span class="n">agg</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;valid_</span><span class="si">{</span><span class="n">feat</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span>

    <span class="n">grouped</span> <span class="o">=</span> <span class="n">experiments</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_feature_keys</span><span class="p">(</span><span class="n">Input</span><span class="p">))</span>
    <span class="n">duplicated_labcodes</span> <span class="o">=</span> <span class="p">[</span>
        <span class="nb">sorted</span><span class="p">(</span><span class="n">group</span><span class="o">.</span><span class="n">labcode</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped</span>
        <span class="k">if</span> <span class="n">group</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span>
    <span class="p">]</span>

    <span class="n">experiments</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">agg</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">feat</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature_keys</span><span class="p">(</span><span class="n">Output</span><span class="p">):</span>
        <span class="n">experiments</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">experiments</span><span class="p">[</span><span class="n">feat</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">(),</span> <span class="sa">f</span><span class="s2">&quot;valid_</span><span class="si">{</span><span class="n">feat</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">experiments</span> <span class="o">=</span> <span class="n">experiments</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;labcode&quot;</span><span class="p">)</span>
    <span class="n">experiments</span> <span class="o">=</span> <span class="n">experiments</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">experiments</span><span class="p">,</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">duplicated_labcodes</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="bofire.data_models.domain.domain.Domain.coerce_invalids" class="doc doc-heading">
<code class="highlight language-python"><span class="n">coerce_invalids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">experiments</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Coerces all invalid output measurements to np.nan</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>experiments</code></td>
        <td><code>pd.DataFrame</code></td>
        <td><p>Dataframe containing experimental data</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>pd.DataFrame</code></td>
      <td><p>coerced dataframe</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>bofire/data_models/domain/domain.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">coerce_invalids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">experiments</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Coerces all invalid output measurements to np.nan</span>

<span class="sd">    Args:</span>
<span class="sd">        experiments (pd.DataFrame): Dataframe containing experimental data</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: coerced dataframe</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># coerce invalid to nan</span>
    <span class="k">for</span> <span class="n">feat</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature_keys</span><span class="p">(</span><span class="n">Output</span><span class="p">):</span>
        <span class="n">experiments</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">experiments</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;valid_</span><span class="si">{</span><span class="n">feat</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">feat</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="k">return</span> <span class="n">experiments</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="bofire.data_models.domain.domain.Domain.describe_experiments" class="doc doc-heading">
<code class="highlight language-python"><span class="n">describe_experiments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">experiments</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Method to get a tabular overview of how many measurements and how many valid entries are included in the input data for each output feature</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>experiments</code></td>
        <td><code>pd.DataFrame</code></td>
        <td><p>Dataframe with experimental data</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>pd.DataFrame</code></td>
      <td><p>Dataframe with counts how many measurements and how many valid entries are included in the input data for each output feature</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>bofire/data_models/domain/domain.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">describe_experiments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">experiments</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Method to get a tabular overview of how many measurements and how many valid entries are included in the input data for each output feature</span>

<span class="sd">    Args:</span>
<span class="sd">        experiments (pd.DataFrame): Dataframe with experimental data</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: Dataframe with counts how many measurements and how many valid entries are included in the input data for each output feature</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">feat</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature_keys</span><span class="p">(</span><span class="n">Output</span><span class="p">):</span>
        <span class="n">data</span><span class="p">[</span><span class="n">feat</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">experiments</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">experiments</span><span class="p">[</span><span class="n">feat</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">experiments</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">experiments</span><span class="p">[</span><span class="n">feat</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">(),</span> <span class="s2">&quot;valid_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">feat</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span>
        <span class="p">]</span>
    <span class="n">preprocessed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">preprocess_experiments_all_valid_outputs</span><span class="p">(</span>
        <span class="n">experiments</span>
    <span class="p">)</span>
    <span class="k">assert</span> <span class="n">preprocessed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;all&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">experiments</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">preprocessed</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span>
        <span class="n">data</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;measured&quot;</span><span class="p">,</span> <span class="s2">&quot;valid&quot;</span><span class="p">]</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>




  <div class="doc doc-object doc-method">



<h3 id="bofire.data_models.domain.domain.Domain.get_constraint_reps_df" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_constraint_reps_df</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Provides a tabular overwiev of all constraints within the domain</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>pd.DataFrame</code></td>
      <td><p>DataFrame listing all constraints of the domain with a description</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>bofire/data_models/domain/domain.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_constraint_reps_df</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Provides a tabular overwiev of all constraints within the domain</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: DataFrame listing all constraints of the domain with a description</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="n">index</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">constraints</span><span class="p">)),</span>
        <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Type&quot;</span><span class="p">,</span> <span class="s2">&quot;Description&quot;</span><span class="p">],</span>
        <span class="n">data</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;Type&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">feat</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="k">for</span> <span class="n">feat</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">constraints</span><span class="p">],</span>
            <span class="s2">&quot;Description&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="n">constraint</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span> <span class="k">for</span> <span class="n">constraint</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">constraints</span>
            <span class="p">],</span>
        <span class="p">},</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="bofire.data_models.domain.domain.Domain.get_feature" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_feature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>get a specific feature by its key</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>key</code></td>
        <td><code>str</code></td>
        <td><p>Feature key</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Feature</code></td>
      <td><p>The feature with the passed key</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>bofire/data_models/domain/domain.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_feature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;get a specific feature by its key</span>

<span class="sd">    Args:</span>
<span class="sd">        key (str): Feature key</span>

<span class="sd">    Returns:</span>
<span class="sd">        Feature: The feature with the passed key</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="n">Inputs</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">{</span><span class="n">f</span><span class="o">.</span><span class="n">key</span><span class="p">:</span> <span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">}[</span><span class="n">key</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="bofire.data_models.domain.domain.Domain.get_feature_keys" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_feature_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">includes</span><span class="o">=&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">bofire</span><span class="o">.</span><span class="n">data_models</span><span class="o">.</span><span class="n">features</span><span class="o">.</span><span class="n">feature</span><span class="o">.</span><span class="n">Feature</span><span class="s1">&#39;&gt;, excludes=None, exact=False)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Method to get feature keys of the domain</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>includes</code></td>
        <td><code>Union[Type, List[Type]]</code></td>
        <td><p>Feature class or list of specific feature classes to be returned. Defaults to Feature.</p></td>
        <td><code>&lt;class &#39;bofire.data_models.features.feature.Feature&#39;&gt;</code></td>
      </tr>
      <tr>
        <td><code>excludes</code></td>
        <td><code>Union[Type, List[Type]]</code></td>
        <td><p>Feature class or list of specific feature classes to be excluded from the return. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>exact</code></td>
        <td><code>bool</code></td>
        <td><p>Boolean to distinguish if only the exact class listed in includes and no subclasses inherenting from this class shall be returned. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[str]</code></td>
      <td><p>List of feature keys fitting to the passed requirements.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>bofire/data_models/domain/domain.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_feature_keys</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">includes</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Type</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Type</span><span class="p">]]</span> <span class="o">=</span> <span class="n">Feature</span><span class="p">,</span>
    <span class="n">excludes</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Type</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Type</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exact</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Method to get feature keys of the domain</span>

<span class="sd">    Args:</span>
<span class="sd">        includes (Union[Type, List[Type]], optional): Feature class or list of specific feature classes to be returned. Defaults to Feature.</span>
<span class="sd">        excludes (Union[Type, List[Type]], optional): Feature class or list of specific feature classes to be excluded from the return. Defaults to None.</span>
<span class="sd">        exact (bool, optional): Boolean to distinguish if only the exact class listed in includes and no subclasses inherenting from this class shall be returned. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[str]: List of feature keys fitting to the passed requirements.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="n">f</span><span class="o">.</span><span class="n">key</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_features</span><span class="p">(</span>
            <span class="n">includes</span><span class="o">=</span><span class="n">includes</span><span class="p">,</span>
            <span class="n">excludes</span><span class="o">=</span><span class="n">excludes</span><span class="p">,</span>
            <span class="n">exact</span><span class="o">=</span><span class="n">exact</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="bofire.data_models.domain.domain.Domain.get_feature_reps_df" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_feature_reps_df</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Returns a pandas dataframe describing the features contained in the optimization domain.</p>

        <details class="quote">
          <summary>Source code in <code>bofire/data_models/domain/domain.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_feature_reps_df</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a pandas dataframe describing the features contained in the optimization domain.&quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_feature_keys</span><span class="p">(</span><span class="n">Feature</span><span class="p">),</span>
        <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Type&quot;</span><span class="p">,</span> <span class="s2">&quot;Description&quot;</span><span class="p">],</span>
        <span class="n">data</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;Type&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="n">feat</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="k">for</span> <span class="n">feat</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_features</span><span class="p">(</span><span class="n">Feature</span><span class="p">)</span>
            <span class="p">],</span>
            <span class="s2">&quot;Description&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">feat</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span> <span class="k">for</span> <span class="n">feat</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_features</span><span class="p">(</span><span class="n">Feature</span><span class="p">)],</span>
        <span class="p">},</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="bofire.data_models.domain.domain.Domain.get_features" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">includes</span><span class="o">=&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">bofire</span><span class="o">.</span><span class="n">data_models</span><span class="o">.</span><span class="n">features</span><span class="o">.</span><span class="n">feature</span><span class="o">.</span><span class="n">Feature</span><span class="s1">&#39;&gt;, excludes=None, exact=False)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>get features of the domain</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>includes</code></td>
        <td><code>Union[Type, List[Type]]</code></td>
        <td><p>Feature class or list of specific feature classes to be returned. Defaults to Feature.</p></td>
        <td><code>&lt;class &#39;bofire.data_models.features.feature.Feature&#39;&gt;</code></td>
      </tr>
      <tr>
        <td><code>excludes</code></td>
        <td><code>Union[Type, List[Type]]</code></td>
        <td><p>Feature class or list of specific feature classes to be excluded from the return. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>exact</code></td>
        <td><code>bool</code></td>
        <td><p>Boolean to distinguish if only the exact class listed in includes and no subclasses inherenting from this class shall be returned. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>by_attribute</code></td>
        <td><code>str</code></td>
        <td><p>If set it is filtered by the attribute specified in by <code>by_attribute</code>. Defaults to None.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[Feature]</code></td>
      <td><p>List of features in the domain fitting to the passed requirements.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>bofire/data_models/domain/domain.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_features</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">includes</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="n">Feature</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="n">Feature</span><span class="p">]]]</span> <span class="o">=</span> <span class="n">Feature</span><span class="p">,</span>
    <span class="n">excludes</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="n">Feature</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="n">Feature</span><span class="p">]],</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">exact</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Features</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;get features of the domain</span>

<span class="sd">    Args:</span>
<span class="sd">        includes (Union[Type, List[Type]], optional): Feature class or list of specific feature classes to be returned. Defaults to Feature.</span>
<span class="sd">        excludes (Union[Type, List[Type]], optional): Feature class or list of specific feature classes to be excluded from the return. Defaults to None.</span>
<span class="sd">        exact (bool, optional): Boolean to distinguish if only the exact class listed in includes and no subclasses inherenting from this class shall be returned. Defaults to False.</span>
<span class="sd">        by_attribute (str, optional): If set it is filtered by the attribute specified in by `by_attribute`. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[Feature]: List of features in the domain fitting to the passed requirements.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="n">Inputs</span><span class="p">)</span>
    <span class="n">features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span>
    <span class="k">return</span> <span class="n">features</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">includes</span><span class="p">,</span> <span class="n">excludes</span><span class="p">,</span> <span class="n">exact</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="bofire.data_models.domain.domain.Domain.get_nchoosek_combinations" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_nchoosek_combinations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exhaustive</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>get all possible NChooseK combinations</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>exhaustive</code></td>
        <td><code>bool</code></td>
        <td><p>if True all combinations are returned. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Tuple(used_features_list, unused_features_list)</code></td>
      <td><p>used_features_list is a list of lists containing features used in each NChooseK combination.
    unused_features_list is a list of lists containing features unused in each NChooseK combination.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>bofire/data_models/domain/domain.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_nchoosek_combinations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exhaustive</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>  <span class="c1"># noqa: C901</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;get all possible NChooseK combinations</span>

<span class="sd">    Args:</span>
<span class="sd">        exhaustive (bool, optional): if True all combinations are returned. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple(used_features_list, unused_features_list): used_features_list is a list of lists containing features used in each NChooseK combination.</span>
<span class="sd">            unused_features_list is a list of lists containing features unused in each NChooseK combination.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">constraints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">NChooseKConstraint</span><span class="p">))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">used_continuous_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature_keys</span><span class="p">(</span><span class="n">ContinuousInput</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">used_continuous_features</span><span class="p">,</span> <span class="p">[]</span>

    <span class="n">used_features_list_all</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># loops through each NChooseK constraint</span>
    <span class="k">for</span> <span class="n">con</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">constraints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">NChooseKConstraint</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">con</span><span class="p">,</span> <span class="n">NChooseKConstraint</span><span class="p">)</span>
        <span class="n">used_features_list</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">exhaustive</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">min_count</span><span class="p">,</span> <span class="n">con</span><span class="o">.</span><span class="n">max_count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">used_features_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">features</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">con</span><span class="o">.</span><span class="n">none_also_valid</span><span class="p">:</span>
                <span class="n">used_features_list</span><span class="o">.</span><span class="n">append</span><span class="p">(())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">used_features_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                <span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">features</span><span class="p">,</span> <span class="n">con</span><span class="o">.</span><span class="n">max_count</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="n">used_features_list_all</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">used_features_list</span><span class="p">)</span>

    <span class="n">used_features_list_all</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
        <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">used_features_list_all</span><span class="p">)</span>
    <span class="p">)</span>  <span class="c1"># product between NChooseK constraints</span>

    <span class="c1"># format into a list of used features</span>
    <span class="n">used_features_list_formatted</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">used_features_list</span> <span class="ow">in</span> <span class="n">used_features_list_all</span><span class="p">:</span>
        <span class="n">used_features_list_flattened</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">item</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">used_features_list</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span>
        <span class="p">]</span>
        <span class="n">used_features_list_formatted</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">used_features_list_flattened</span><span class="p">)))</span>

    <span class="c1"># sort lists</span>
    <span class="n">used_features_list_sorted</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">used_features</span> <span class="ow">in</span> <span class="n">used_features_list_formatted</span><span class="p">:</span>
        <span class="n">used_features_list_sorted</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">used_features</span><span class="p">))</span>

    <span class="c1"># drop duplicates</span>
    <span class="n">used_features_list_no_dup</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">used_features</span> <span class="ow">in</span> <span class="n">used_features_list_sorted</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">used_features</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">used_features_list_no_dup</span><span class="p">:</span>
            <span class="n">used_features_list_no_dup</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">used_features</span><span class="p">)</span>

    <span class="c1"># print(f&quot;duplicates dropped: {len(used_features_list_sorted)-len(used_features_list_no_dup)}&quot;)</span>

    <span class="c1"># remove combinations not fulfilling constraints</span>
    <span class="n">used_features_list_final</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">combo</span> <span class="ow">in</span> <span class="n">used_features_list_no_dup</span><span class="p">:</span>
        <span class="n">fulfil_constraints</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">[]</span>
        <span class="p">)</span>  <span class="c1"># list of bools tracking if constraints are fulfilled</span>
        <span class="k">for</span> <span class="n">con</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">constraints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">NChooseKConstraint</span><span class="p">):</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">con</span><span class="p">,</span> <span class="n">NChooseKConstraint</span><span class="p">)</span>
            <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># count of features in combo that are in con.features</span>
            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">combo</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">con</span><span class="o">.</span><span class="n">features</span><span class="p">:</span>
                    <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;=</span> <span class="n">con</span><span class="o">.</span><span class="n">min_count</span> <span class="ow">and</span> <span class="n">count</span> <span class="o">&lt;=</span> <span class="n">con</span><span class="o">.</span><span class="n">max_count</span><span class="p">:</span>
                <span class="n">fulfil_constraints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">con</span><span class="o">.</span><span class="n">none_also_valid</span><span class="p">:</span>
                <span class="n">fulfil_constraints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fulfil_constraints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">fulfil_constraints</span><span class="p">):</span>
            <span class="n">used_features_list_final</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">combo</span><span class="p">)</span>

    <span class="c1"># print(f&quot;violators dropped: {len(used_features_list_no_dup)-len(used_features_list_final)}&quot;)</span>

    <span class="c1"># features unused</span>
    <span class="n">features_in_cc</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">con</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">constraints</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">NChooseKConstraint</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">con</span><span class="p">,</span> <span class="n">NChooseKConstraint</span><span class="p">)</span>
        <span class="n">features_in_cc</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">features</span><span class="p">)</span>
    <span class="n">features_in_cc</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">features_in_cc</span><span class="p">))</span>
    <span class="n">features_in_cc</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="n">unused_features_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">used_features</span> <span class="ow">in</span> <span class="n">used_features_list_final</span><span class="p">:</span>
        <span class="n">unused_features_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="p">[</span><span class="n">f_key</span> <span class="k">for</span> <span class="n">f_key</span> <span class="ow">in</span> <span class="n">features_in_cc</span> <span class="k">if</span> <span class="n">f_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">used_features</span><span class="p">]</span>
        <span class="p">)</span>

    <span class="c1"># postprocess</span>
    <span class="c1"># used_features_list_final2 = []</span>
    <span class="c1"># unused_features_list2 = []</span>
    <span class="c1"># for used, unused in zip(used_features_list_final,unused_features_list):</span>
    <span class="c1">#     if len(used) == 3:</span>
    <span class="c1">#         used_features_list_final2.append(used), unused_features_list2.append(unused)</span>

    <span class="k">return</span> <span class="n">used_features_list_final</span><span class="p">,</span> <span class="n">unused_features_list</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="bofire.data_models.domain.domain.Domain.validate_candidates" class="doc doc-heading">
<code class="highlight language-python"><span class="n">validate_candidates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">candidates</span><span class="p">,</span> <span class="n">only_inputs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">,</span> <span class="n">raise_validation_error</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Method to check the validty of porposed candidates</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>candidates</code></td>
        <td><code>pd.DataFrame</code></td>
        <td><p>Dataframe with suggested new experiments (candidates)</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>only_inputs</code></td>
        <td><code>bool,optional</code></td>
        <td><p>If True, only the input columns are validated. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
      <tr>
        <td><code>tol</code></td>
        <td><code>float,optional</code></td>
        <td><p>tolerance parameter for constraints. A constraint is considered as not fulfilled if the violation
is larger than tol. Defaults to 1e-6.</p></td>
        <td><code>1e-05</code></td>
      </tr>
      <tr>
        <td><code>raise_validation_error</code></td>
        <td><code>bool</code></td>
        <td><p>If true an error will be raised if candidates violate constraints,
otherwise only a warning will be displayed. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>when a column is missing for a defined input feature</p></td>
      </tr>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>when a column is missing for a defined output feature</p></td>
      </tr>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>when a non-numerical value is proposed</p></td>
      </tr>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>when an additional column is found</p></td>
      </tr>
      <tr>
        <td><code>ConstraintNotFulfilledError</code></td>
        <td><p>when the constraints are not fulfilled and <code>raise_validation_error = True</code></p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>pd.DataFrame</code></td>
      <td><p>dataframe with suggested experiments (candidates)</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>bofire/data_models/domain/domain.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">validate_candidates</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">candidates</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">only_inputs</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">tol</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-5</span><span class="p">,</span>
    <span class="n">raise_validation_error</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Method to check the validty of porposed candidates</span>

<span class="sd">    Args:</span>
<span class="sd">        candidates (pd.DataFrame): Dataframe with suggested new experiments (candidates)</span>
<span class="sd">        only_inputs (bool,optional): If True, only the input columns are validated. Defaults to False.</span>
<span class="sd">        tol (float,optional): tolerance parameter for constraints. A constraint is considered as not fulfilled if the violation</span>
<span class="sd">            is larger than tol. Defaults to 1e-6.</span>
<span class="sd">        raise_validation_error (bool, optional): If true an error will be raised if candidates violate constraints,</span>
<span class="sd">            otherwise only a warning will be displayed. Defaults to True.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: when a column is missing for a defined input feature</span>
<span class="sd">        ValueError: when a column is missing for a defined output feature</span>
<span class="sd">        ValueError: when a non-numerical value is proposed</span>
<span class="sd">        ValueError: when an additional column is found</span>
<span class="sd">        ConstraintNotFulfilledError: when the constraints are not fulfilled and `raise_validation_error = True`</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: dataframe with suggested experiments (candidates)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># check that each input feature has a col and is valid in itself</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="n">Inputs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">validate_inputs</span><span class="p">(</span><span class="n">candidates</span><span class="p">)</span>
    <span class="c1"># check if all constraints are fulfilled</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">constraints</span><span class="o">.</span><span class="n">is_fulfilled</span><span class="p">(</span><span class="n">candidates</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="n">tol</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">raise_validation_error</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ConstraintNotFulfilledError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Constraints not fulfilled: </span><span class="si">{</span><span class="n">candidates</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Not all constraints are fulfilled.&quot;</span><span class="p">)</span>
    <span class="c1"># for each continuous output feature with an attached objective object</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">only_inputs</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">,</span> <span class="n">Outputs</span><span class="p">)</span>

        <span class="n">cols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
            <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">_pred&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">_sd&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">_des&quot;</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">get_keys_by_objective</span><span class="p">(</span><span class="n">Objective</span><span class="p">)</span>
                <span class="p">]</span>
                <span class="o">+</span> <span class="p">[</span>
                    <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">_pred&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">_sd&quot;</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">get_keys_by_objective</span><span class="p">(</span>
                        <span class="n">excludes</span><span class="o">=</span><span class="n">Objective</span><span class="p">,</span> <span class="n">includes</span><span class="o">=</span><span class="kc">None</span>  <span class="c1"># type: ignore</span>
                    <span class="p">)</span>
                <span class="p">]</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># check that pred, sd, and des cols are specified and numerical</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;missing column </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">is_numeric</span><span class="p">(</span><span class="n">candidates</span><span class="p">[</span><span class="n">col</span><span class="p">]))</span> <span class="ow">and</span> <span class="p">(</span>
                <span class="ow">not</span> <span class="n">candidates</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
            <span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;not all values of column `</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">` are numerical&quot;</span><span class="p">)</span>

        <span class="c1"># validate no additional cols exist</span>
        <span class="n">if_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_features</span><span class="p">(</span><span class="n">Input</span><span class="p">))</span>
        <span class="n">of_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">get_by_objective</span><span class="p">(</span><span class="n">includes</span><span class="o">=</span><span class="n">Objective</span><span class="p">))</span>
        <span class="n">of_count_w</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">get_by_objective</span><span class="p">(</span><span class="n">excludes</span><span class="o">=</span><span class="n">Objective</span><span class="p">,</span> <span class="n">includes</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>  <span class="c1"># type: ignore</span>
        <span class="c1"># input features, prediction, standard deviation and reward for each output feature, 3 additional usefull infos: reward, aquisition function, strategy</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">candidates</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">!=</span> <span class="n">if_count</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">of_count</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">of_count_w</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;additional columns found&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">candidates</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="bofire.data_models.domain.domain.Domain.validate_constraints" class="doc doc-heading">
<code class="highlight language-python"><span class="n">validate_constraints</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Validate if all features included in the constraints are also defined as features for the domain.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>v</code></td>
        <td><code>List[Constraint]</code></td>
        <td><p>List of constraints or empty if no constraints are defined</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>values</code></td>
        <td><code>List[Input]</code></td>
        <td><p>List of input features of the domain</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>Feature key in constraint is unknown.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[Constraint]</code></td>
      <td><p>List of constraints defined for the domain</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>bofire/data_models/domain/domain.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@validator</span><span class="p">(</span><span class="s2">&quot;constraints&quot;</span><span class="p">,</span> <span class="n">always</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">validate_constraints</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate if all features included in the constraints are also defined as features for the domain.</span>

<span class="sd">    Args:</span>
<span class="sd">        v (List[Constraint]): List of constraints or empty if no constraints are defined</span>
<span class="sd">        values (List[Input]): List of input features of the domain</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: Feature key in constraint is unknown.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[Constraint]: List of constraints defined for the domain</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;inputs&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">v</span>
    <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">key</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">values</span><span class="p">[</span><span class="s2">&quot;inputs&quot;</span><span class="p">]]</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">LinearConstraint</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">NChooseKConstraint</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">c</span><span class="o">.</span><span class="n">features</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">f</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;feature </span><span class="si">{</span><span class="n">f</span><span class="si">}</span><span class="s2"> in constraint unknown (</span><span class="si">{</span><span class="n">keys</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">v</span>
</code></pre></div>
        </details>
    </div>

  </div>




  <div class="doc doc-object doc-method">



<h3 id="bofire.data_models.domain.domain.Domain.validate_experiments" class="doc doc-heading">
<code class="highlight language-python"><span class="n">validate_experiments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">experiments</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>checks the experimental data on validity</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>experiments</code></td>
        <td><code>pd.DataFrame</code></td>
        <td><p>Dataframe with experimental data</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>empty dataframe</p></td>
      </tr>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>the column for a specific feature is missing the provided data</p></td>
      </tr>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>there are labcodes with null value</p></td>
      </tr>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>there are labcodes with nan value</p></td>
      </tr>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>labcodes are not unique</p></td>
      </tr>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>the provided columns do no match to the defined domain</p></td>
      </tr>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>the provided columns do no match to the defined domain</p></td>
      </tr>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>Input with null values</p></td>
      </tr>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>Input with nan values</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>pd.DataFrame</code></td>
      <td><p>The provided dataframe with experimental data</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>bofire/data_models/domain/domain.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">validate_experiments</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">experiments</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">strict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;checks the experimental data on validity</span>

<span class="sd">    Args:</span>
<span class="sd">        experiments (pd.DataFrame): Dataframe with experimental data</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: empty dataframe</span>
<span class="sd">        ValueError: the column for a specific feature is missing the provided data</span>
<span class="sd">        ValueError: there are labcodes with null value</span>
<span class="sd">        ValueError: there are labcodes with nan value</span>
<span class="sd">        ValueError: labcodes are not unique</span>
<span class="sd">        ValueError: the provided columns do no match to the defined domain</span>
<span class="sd">        ValueError: the provided columns do no match to the defined domain</span>
<span class="sd">        ValueError: Input with null values</span>
<span class="sd">        ValueError: Input with nan values</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: The provided dataframe with experimental data</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">experiments</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;no experiments provided (empty dataframe)&quot;</span><span class="p">)</span>
    <span class="c1"># check that each feature is a col</span>
    <span class="n">feature_keys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature_keys</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">feature_key</span> <span class="ow">in</span> <span class="n">feature_keys</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">feature_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">experiments</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;no col in experiments for feature </span><span class="si">{</span><span class="n">feature_key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># add valid_{key} cols if missing</span>
    <span class="n">valid_keys</span> <span class="o">=</span> <span class="p">[</span>
        <span class="sa">f</span><span class="s2">&quot;valid_</span><span class="si">{</span><span class="n">output_feature_key</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">output_feature_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_feature_keys</span><span class="p">(</span><span class="n">Output</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="k">for</span> <span class="n">valid_key</span> <span class="ow">in</span> <span class="n">valid_keys</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">valid_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">experiments</span><span class="p">:</span>
            <span class="n">experiments</span><span class="p">[</span><span class="n">valid_key</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="c1"># check all cols</span>
    <span class="n">cols</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">experiments</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="c1"># we allow here for a column named labcode used to identify experiments</span>
    <span class="k">if</span> <span class="s2">&quot;labcode&quot;</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
        <span class="c1"># test that labcodes are not na</span>
        <span class="k">if</span> <span class="n">experiments</span><span class="o">.</span><span class="n">labcode</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;there are labcodes with null value&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">experiments</span><span class="o">.</span><span class="n">labcode</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;there are labcodes with nan value&quot;</span><span class="p">)</span>
        <span class="c1"># test that labcodes are distinct</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">experiments</span><span class="o">.</span><span class="n">labcode</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>
            <span class="o">!=</span> <span class="n">experiments</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;labcodes are not unique&quot;</span><span class="p">)</span>
        <span class="c1"># we remove the labcode from the cols list to proceed as before</span>
        <span class="n">cols</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;labcode&quot;</span><span class="p">)</span>
    <span class="c1"># check values of continuous input features</span>
    <span class="k">if</span> <span class="n">experiments</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_feature_keys</span><span class="p">(</span><span class="n">Input</span><span class="p">)]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;there are null values&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">experiments</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_feature_keys</span><span class="p">(</span><span class="n">Input</span><span class="p">)]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;there are na values&quot;</span><span class="p">)</span>
    <span class="c1"># run the individual validators</span>
    <span class="k">for</span> <span class="n">feat</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_features</span><span class="p">(</span><span class="n">Input</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">feat</span><span class="p">,</span> <span class="n">Input</span><span class="p">)</span>
        <span class="n">feat</span><span class="o">.</span><span class="n">validate_experimental</span><span class="p">(</span><span class="n">experiments</span><span class="p">[</span><span class="n">feat</span><span class="o">.</span><span class="n">key</span><span class="p">],</span> <span class="n">strict</span><span class="o">=</span><span class="n">strict</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">experiments</span>
</code></pre></div>
        </details>
    </div>

  </div>




  <div class="doc doc-object doc-method">



<h3 id="bofire.data_models.domain.domain.Domain.validate_linear_constraints" class="doc doc-heading">
<code class="highlight language-python"><span class="n">validate_linear_constraints</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Validate if all features included in linear constraints are continuous ones.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>v</code></td>
        <td><code>List[Constraint]</code></td>
        <td><p>List of constraints or empty if no constraints are defined</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>values</code></td>
        <td><code>List[Input]</code></td>
        <td><p>List of input features of the domain</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p><em>description</em></p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[Constraint]</code></td>
      <td><p>List of constraints defined for the domain</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>bofire/data_models/domain/domain.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@validator</span><span class="p">(</span><span class="s2">&quot;constraints&quot;</span><span class="p">,</span> <span class="n">always</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">validate_linear_constraints</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate if all features included in linear constraints are continuous ones.</span>

<span class="sd">    Args:</span>
<span class="sd">        v (List[Constraint]): List of constraints or empty if no constraints are defined</span>
<span class="sd">        values (List[Input]): List of input features of the domain</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: _description_</span>


<span class="sd">    Returns:</span>
<span class="sd">       List[Constraint]: List of constraints defined for the domain</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;inputs&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">v</span>

    <span class="c1"># gather continuous inputs in dictionary</span>
    <span class="n">continuous_inputs_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">values</span><span class="p">[</span><span class="s2">&quot;inputs&quot;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ContinuousInput</span><span class="p">):</span>
            <span class="n">continuous_inputs_dict</span><span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span>

    <span class="c1"># check if non continuous input features appear in linear constraints</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">LinearConstraint</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">c</span><span class="o">.</span><span class="n">features</span><span class="p">:</span>
                <span class="k">assert</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">continuous_inputs_dict</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">f</span><span class="si">}</span><span class="s2"> must be continuous.&quot;</span>
    <span class="k">return</span> <span class="n">v</span>
</code></pre></div>
        </details>
    </div>

  </div>




  <div class="doc doc-object doc-method">



<h3 id="bofire.data_models.domain.domain.Domain.validate_unique_feature_keys" class="doc doc-heading">
<code class="highlight language-python"><span class="n">validate_unique_feature_keys</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Validates if provided input and output feature keys are unique</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>v</code></td>
        <td><code>Outputs</code></td>
        <td><p>List of all output features of the domain.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>value</code></td>
        <td><code>Dict[str, Inputs]</code></td>
        <td><p>Dict containing a list of input features as single entry.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>Feature keys are not unique.</p></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Outputs</code></td>
      <td><p>Keeps output features as given.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>bofire/data_models/domain/domain.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@validator</span><span class="p">(</span><span class="s2">&quot;outputs&quot;</span><span class="p">,</span> <span class="n">always</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">validate_unique_feature_keys</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="n">Outputs</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Outputs</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validates if provided input and output feature keys are unique</span>

<span class="sd">    Args:</span>
<span class="sd">        v (Outputs): List of all output features of the domain.</span>
<span class="sd">        value (Dict[str, Inputs]): Dict containing a list of input features as single entry.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: Feature keys are not unique.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Outputs: Keeps output features as given.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;inputs&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">v</span>
    <span class="n">features</span> <span class="o">=</span> <span class="n">v</span> <span class="o">+</span> <span class="n">values</span><span class="p">[</span><span class="s2">&quot;inputs&quot;</span><span class="p">]</span>
    <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">key</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">features</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">keys</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;feature keys are not unique&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">v</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>









  </div>

    </div>

  </div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["toc.integrate"], "search": "../assets/javascripts/workers/search.dfff1995.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.78eede0e.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>